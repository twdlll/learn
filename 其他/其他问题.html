<!DOCTYPE html>
<!-- saved from url=(0016)http://localhost -->
<html>
  <head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <title>其他问题</title>
    <style>
        body{
            margin: 0;
        }
        #content-info{
            width: auto;
            margin: 0 auto;
            text-align: center;
        }
        #author-info{
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }
        #title{
            text-overflow: ellipsis;
            white-space: nowrap;
            overflow: hidden;
            padding-top: 10px;
            margin-bottom: 2px;
            font-size: 34px;
            color: #505050;
        }
        .text{
            white-space:nowrap;
            text-overflow: ellipsis;
            display: inline-block;
            margin-right: 20px;
            margin-bottom: 2px;
            font-size: 20px;
            color: #8c8c8c;
        }
        #navBar{
            width: auto;
            height: auto;
            position: fixed;
            right:0;
            bottom: 0;
            background-color: #f0f3f4;
            overflow-y: auto;
            text-align: center;
        }
        #svg-container{
            width: 100%;
            overflow-x: scroll;
            min-width: 0px;
            margin: 0 10px;
        }
        #nav-thumbs{
            overflow-y: scroll;
            padding: 0 5px;
        }
        .nav-thumb{
            position: relative;
            margin: 10px auto;
        }
        .nav-thumb >p{
            text-align: center;
            font-size: 12px;
            margin: 4px 0 0 0;
        }
        .nav-thumb >div{
            position: relative;
            display: inline-block;
            border: 1px solid #c6cfd5;
        }
        .nav-thumb img{
            display: block;
        }
        #main-content{
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #d0cfd8;
            display: flex;
            height: auto;
            flex-flow: row wrap;
            text-align:center;
        }
        #svg-container >svg{
            display: block;
            margin:10px auto;
            margin-bottom: 0;
        }
        #copyright{
            bottom: 0;
            left: 50%;
            margin: 5px auto;
            font-size: 16px;
            color: #515151;
        }
        #copyright >a{
            text-decoration: none;
            color: #77C;
        }
        .number{
            position: absolute;
            top:0;
            left:0;
            border-top:22px solid #08a1ef;
            border-right: 22px solid transparent;
        }
        .pagenum{
            font-size: 12px;
            color: #fff;
            position: absolute;
            top: -23px;
            left: 2px;
        }
            #navBar::-webkit-scrollbar{
            width: 8px;
            background-color: #f5f5f5;
        }
            #navBar::-webkit-scrollbar-track{
            -webkit-box-shadow: inset 0 0 4px rgba(0,0,0,.3);
            border-radius: 8px;
            background-color: #fff;
        }
            #navBar::-webkit-scrollbar-thumb{
            border-radius: 8px;
            -webkit-box-shadow: inset 0 0 4px rgba(0,0,0,.3);
            background-color: #6b6b70;
        }
        #navBar::-webkit-scrollbar-thumb:hover{
            background-color: #4a4a4f;
        }
</style>
  </head>
  <body>
    <div id="main-area">
      <div id="main-content">
        <div id="svg-container"><svg xmlns:xlink="http://www.w3.org/1999/xlink" height="962" ed:name="Page-1" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:ed="https://www.edrawsoft.cn/xml/2017/SVGExtensions/" ed:hSpacing="30" width="1632" ed:vSpacing="30" viewBox="0 0 1632 962" id="page1" preserveAspectRadio="xMinYMin meet">
    <style type="text/css"><![CDATA[
g[ed\:togtopicid],g[ed\:hyperlink],g[ed\:comment],g[ed\:note] {cursor:pointer;}
g[id] {-moz-user-select: none;-ms-user-select: none;user-select: none;}
svg text::selection,svg tspan::selection{background-color: #4285f4;color: #ffffff;fill: #ffffff;}
.st48 {fill:#454545;font-family:Consolas;font-size:10pt}
.st47 {fill:#454545;font-family:Consolas;font-size:12pt}
.st46 {fill:#454545;font-family:Consolas;font-size:14pt}
]]></style>
    <defs>
        <linearGradient y2="100%" y1="0%" x1="0%" x2="0%" id="lg14">
            <stop offset="0" stop-color="#ffffff"/>
            <stop offset="0.25" stop-color="#f0f5f0"/>
            <stop offset="0.75" stop-color="#e1ebe1"/>
            <stop offset="1" stop-color="#c8d7c8"/>
        </linearGradient>
    </defs>
    <rect height="962" y="0" x="0" width="1632" fill="#fbfcfb"/>
    <path stroke-linejoin="round" stroke="#ff7575" ed:parentid="101" d="M-35.5,183.3C-36.1,185,-35.5,186.5,-34.2,187C-32.9,187.5,-31.4,186.8,-30.8,185.1C-30,182.8,-29.2,180.6,-28.5,178.3C-27.8,176,-27.2,173.7,-26.6,171.4C-26,169.2,-25.5,166.9,-25,164.6C-24.5,162.2,-24,159.9,-23.6,157.6C-23.1,155.3,-22.7,153,-22.3,150.7C-21.9,148.4,-21.6,146,-21.3,143.7C-20.9,141.4,-20.6,139.1,-20.3,136.7C-20,134.4,-19.7,132.1,-19.5,129.8C-19.2,127.4,-19,125.1,-18.7,122.8C-18.5,120.4,-18.3,118.1,-18.1,115.8C-17.8,113.5,-17.6,111.1,-17.5,108.8C-17.3,106.5,-17.1,104.1,-16.9,101.8C-16.7,99.5,-16.6,97.1,-16.4,94.8C-16.3,92.5,-16.1,90.1,-16,87.8C-15.8,85.5,-15.7,83.1,-15.6,80.8C-15.4,78.5,-15.3,76.1,-15.2,73.8C-15.1,71.5,-15,69.1,-14.8,66.8C-14.7,64.5,-14.6,62.1,-14.5,59.8C-14.4,57.5,-14.3,55.1,-14.2,52.8C-14.1,50.5,-14,48.1,-13.9,45.8C-13.8,43.5,-13.7,41.1,-13.6,38.8C-13.5,36.5,-13.4,34.2,-13.3,31.8C-13.2,29.5,-13.1,27.2,-13,24.8C-12.9,22.5,-12.8,20.2,-12.7,17.8C-12.6,15.5,-12.6,13.2,-12.5,10.8C-12.4,8.5,-12.3,6.2,-12.2,3.8C-12.1,1.5,-11.9,-0.8,-11.8,-3.1C-11.7,-5.5,-11.6,-7.8,-11.5,-10.1C-11.4,-12.5,-11.3,-14.8,-11.2,-17.1C-11.1,-19.4,-10.9,-21.8,-10.8,-24.1C-10.7,-26.4,-10.6,-28.8,-10.4,-31.1C-10.3,-33.4,-10.2,-35.7,-10,-38.1C-9.9,-40.4,-9.7,-42.7,-9.6,-45C-9.4,-47.4,-9.2,-49.7,-9.1,-52C-8.9,-54.3,-8.7,-56.7,-8.5,-59C-8.4,-61.3,-8.2,-63.6,-8,-66C-7.8,-68.3,-7.6,-70.6,-7.3,-72.9C-7.1,-75.2,-6.9,-77.6,-6.7,-79.9C-6.4,-82.2,-6.2,-84.5,-5.9,-86.8C-5.7,-89.1,-5.4,-91.5,-5.1,-93.8C-4.8,-96.1,-4.5,-98.4,-4.2,-100.7C-3.9,-103,-3.6,-105.3,-3.2,-107.6C-2.9,-109.9,-2.5,-112.2,-2.1,-114.5C-1.8,-116.8,-1.4,-119.1,-1,-121.4C-0.5,-123.7,-0.1,-126,0.3,-128.2C0.8,-130.5,1.3,-132.8,1.8,-135.1C2.3,-137.3,2.8,-139.6,3.4,-141.9C4,-144.1,4.5,-146.4,5.2,-148.6C5.8,-150.8,6.4,-153.1,7.1,-155.3C7.8,-157.5,8.6,-159.7,9.3,-161.9C10.1,-164.1,10.9,-166.3,11.8,-168.4C12.7,-170.6,13.6,-172.7,14.6,-174.8C15.6,-176.9,16.6,-179,17.7,-181C18.8,-183,20,-185,21.2,-187C22.5,-188.9,23.8,-190.8,25.3,-192.6C26.7,-194.4,28.2,-196.2,29.8,-197.8C31.4,-199.5,33.1,-201,34.9,-202.5C36.7,-203.9,38.6,-205.2,40.6,-206.3C42.7,-207.5,44.8,-208.5,46.9,-209.3C49,-210.1,51.1,-210.7,53.5,-211.2C55.9,-211.7,58.7,-212,60.4,-212.1C62,-212.2,62.6,-212.2,63.1,-212.2C63.5,-212.2,63.7,-212.4,63.7,-212.7C63.7,-213,63.5,-213.2,63.1,-213.2C62.6,-213.2,62,-213.2,60.3,-213.1C58.6,-213,55.8,-212.7,53.3,-212.3C50.8,-211.8,48.7,-211.2,46.5,-210.4C44.3,-209.6,42.1,-208.6,40,-207.4C38,-206.2,36,-204.9,34.1,-203.5C32.3,-202,30.5,-200.5,28.8,-198.8C27.2,-197.1,25.6,-195.3,24.1,-193.5C22.7,-191.7,21.3,-189.7,20,-187.8C18.7,-185.8,17.5,-183.8,16.3,-181.7C15.2,-179.7,14.1,-177.6,13.1,-175.5C12.1,-173.4,11.2,-171.2,10.3,-169C9.4,-166.9,8.5,-164.7,7.7,-162.5C6.9,-160.3,6.1,-158.1,5.4,-155.8C4.7,-153.6,4,-151.4,3.4,-149.1C2.7,-146.9,2.1,-144.6,1.5,-142.3C0.9,-140.1,0.4,-137.8,-0.2,-135.5C-0.7,-133.2,-1.2,-131,-1.7,-128.7C-2.2,-126.4,-2.6,-124.1,-3.1,-121.8C-3.5,-119.5,-3.9,-117.2,-4.3,-114.9C-4.7,-112.6,-5.1,-110.3,-5.5,-108C-5.8,-105.6,-6.2,-103.3,-6.5,-101C-6.8,-98.7,-7.2,-96.4,-7.5,-94.1C-7.8,-91.7,-8.1,-89.4,-8.4,-87.1C-8.6,-84.8,-8.9,-82.5,-9.2,-80.1C-9.4,-77.8,-9.7,-75.5,-9.9,-73.2C-10.2,-70.9,-10.4,-68.5,-10.6,-66.2C-10.8,-63.9,-11,-61.5,-11.3,-59.2C-11.5,-56.9,-11.7,-54.6,-11.8,-52.2C-12,-49.9,-12.2,-47.6,-12.4,-45.2C-12.6,-42.9,-12.8,-40.6,-12.9,-38.3C-13.1,-35.9,-13.2,-33.6,-13.4,-31.3C-13.6,-28.9,-13.7,-26.6,-13.9,-24.3C-14,-21.9,-14.1,-19.6,-14.3,-17.3C-14.4,-15,-14.6,-12.6,-14.7,-10.3C-14.8,-8,-15,-5.6,-15.1,-3.3C-15.2,-1,-15.3,1.4,-15.5,3.7C-15.6,6,-15.7,8.4,-15.8,10.7C-15.9,13,-16.1,15.3,-16.2,17.7C-16.3,20,-16.4,22.3,-16.5,24.7C-16.6,27,-16.8,29.3,-16.9,31.7C-17,34,-17.1,36.3,-17.2,38.6C-17.3,41,-17.5,43.3,-17.6,45.6C-17.7,48,-17.8,50.3,-18,52.6C-18.1,55,-18.2,57.3,-18.3,59.6C-18.5,61.9,-18.6,64.3,-18.7,66.6C-18.9,68.9,-19,71.3,-19.1,73.6C-19.3,75.9,-19.4,78.2,-19.6,80.6C-19.7,82.9,-19.9,85.2,-20.1,87.5C-20.2,89.9,-20.4,92.2,-20.6,94.5C-20.7,96.8,-20.9,99.1,-21.1,101.5C-21.3,103.8,-21.5,106.1,-21.7,108.4C-21.9,110.7,-22.2,113.1,-22.4,115.4C-22.6,117.7,-22.9,120,-23.1,122.3C-23.4,124.6,-23.6,126.9,-23.9,129.2C-24.2,131.5,-24.5,133.8,-24.8,136.1C-25.1,138.4,-25.5,140.7,-25.8,143C-26.2,145.3,-26.5,147.6,-26.9,149.9C-27.3,152.2,-27.8,154.5,-28.2,156.7C-28.7,159,-29.1,161.3,-29.7,163.5C-30.2,165.8,-30.7,168,-31.3,170.2C-31.9,172.4,-32.5,174.7,-33.2,176.8C-33.9,179,-34.7,181.2,-35.5,183.3z" stroke-linecap="round" transform="matrix(1,0,0,1,889,268)" id="103" ed:tosuperid="102" fill="#ff7575"/>
    <path stroke-linejoin="round" stroke="#5fb7f1" ed:parentid="101" d="M-31.5,100.3C-32.2,101.9,-31.6,103.5,-30.4,104C-29.1,104.5,-27.5,103.9,-26.9,102.2C-26,100,-25.1,97.8,-24.4,95.5C-23.6,93.3,-22.9,91,-22.2,88.7C-21.5,86.5,-20.9,84.2,-20.3,81.9C-19.8,79.6,-19.2,77.3,-18.7,75C-18.2,72.7,-17.7,70.4,-17.2,68.1C-16.8,65.8,-16.3,63.5,-15.9,61.2C-15.5,58.9,-15.1,56.6,-14.7,54.3C-14.3,52,-14,49.7,-13.6,47.3C-13.3,45,-12.9,42.7,-12.6,40.4C-12.3,38.1,-11.9,35.8,-11.6,33.5C-11.3,31.1,-11,28.8,-10.7,26.5C-10.4,24.2,-10.1,21.9,-9.8,19.6C-9.5,17.2,-9.2,14.9,-8.9,12.6C-8.6,10.3,-8.3,8,-8,5.7C-7.7,3.4,-7.3,1.1,-7,-1.3C-6.7,-3.6,-6.4,-5.9,-6.1,-8.2C-5.8,-10.5,-5.5,-12.8,-5.1,-15.1C-4.8,-17.4,-4.5,-19.7,-4.1,-22C-3.7,-24.3,-3.4,-26.6,-3,-28.9C-2.6,-31.2,-2.2,-33.5,-1.8,-35.8C-1.4,-38.1,-1,-40.4,-0.6,-42.7C-0.2,-45,0.3,-47.2,0.8,-49.5C1.3,-51.8,1.8,-54.1,2.3,-56.3C2.8,-58.6,3.3,-60.8,3.9,-63.1C4.5,-65.3,5.1,-67.6,5.8,-69.8C6.4,-72,7.1,-74.3,7.8,-76.5C8.5,-78.7,9.3,-80.9,10.1,-83C10.9,-85.2,11.8,-87.4,12.7,-89.5C13.6,-91.6,14.6,-93.7,15.6,-95.8C16.6,-97.8,17.7,-99.9,18.9,-101.8C20.1,-103.8,21.4,-105.8,22.7,-107.6C24.1,-109.5,25.5,-111.3,27.1,-113C28.6,-114.7,30.2,-116.3,32,-117.8C33.7,-119.3,35.6,-120.7,37.5,-122C39.4,-123.2,41.5,-124.3,43.6,-125.2C45.7,-126.2,47.8,-126.9,50.1,-127.5C52.3,-128.1,54.7,-128.6,56.9,-128.8C59,-129.1,61.1,-129.2,63.1,-129.2C63.5,-129.2,63.7,-129.4,63.7,-129.7C63.7,-130,63.5,-130.2,63.1,-130.2C61,-130.2,59,-130.1,56.7,-129.9C54.5,-129.7,52.1,-129.3,49.8,-128.7C47.5,-128.1,45.2,-127.3,43.1,-126.4C40.9,-125.5,38.8,-124.4,36.7,-123.2C34.7,-121.9,32.8,-120.5,31,-119C29.2,-117.5,27.5,-115.8,25.9,-114.1C24.3,-112.4,22.8,-110.5,21.3,-108.7C19.9,-106.8,18.6,-104.8,17.4,-102.8C16.1,-100.8,15,-98.7,13.9,-96.7C12.8,-94.6,11.8,-92.4,10.8,-90.3C9.8,-88.2,8.9,-86,8.1,-83.8C7.2,-81.6,6.4,-79.4,5.7,-77.2C4.9,-75,4.2,-72.7,3.5,-70.5C2.8,-68.2,2.2,-66,1.5,-63.7C0.9,-61.5,0.3,-59.2,-0.2,-56.9C-0.8,-54.6,-1.3,-52.4,-1.8,-50.1C-2.4,-47.8,-2.8,-45.5,-3.3,-43.2C-3.8,-40.9,-4.2,-38.6,-4.7,-36.3C-5.1,-34,-5.6,-31.7,-6,-29.4C-6.4,-27.1,-6.8,-24.8,-7.2,-22.5C-7.5,-20.2,-7.9,-17.9,-8.3,-15.6C-8.7,-13.3,-9,-11,-9.4,-8.7C-9.7,-6.4,-10.1,-4,-10.4,-1.7C-10.8,0.6,-11.1,2.9,-11.4,5.2C-11.8,7.5,-12.1,9.8,-12.5,12.1C-12.8,14.4,-13.1,16.7,-13.5,19.1C-13.8,21.4,-14.1,23.7,-14.5,26C-14.8,28.3,-15.2,30.6,-15.5,32.9C-15.9,35.2,-16.2,37.5,-16.6,39.8C-17,42.1,-17.3,44.4,-17.7,46.7C-18.1,49,-18.5,51.3,-18.9,53.6C-19.3,55.8,-19.8,58.1,-20.2,60.4C-20.7,62.7,-21.1,65,-21.6,67.2C-22.1,69.5,-22.6,71.7,-23.2,74C-23.7,76.2,-24.3,78.5,-24.9,80.7C-25.5,82.9,-26.1,85.2,-26.8,87.4C-27.5,89.5,-28.2,91.7,-29,93.9C-29.8,96,-30.6,98.1,-31.5,100.3z" stroke-linecap="round" transform="matrix(1,0,0,1,889,351)" id="106" ed:tosuperid="105" fill="#5fb7f1"/>
    <path stroke-linejoin="round" stroke="#5fb7f1" ed:parentid="105" stroke-linecap="round" d="M-13.5,54.8C5.4,54.8,-13.5,-54.8,13.5,-54.8" transform="matrix(1,0,0,1,1066,167)" stroke-width="2" id="108" ed:tosuperid="107" fill="none"/>
    <path stroke-linejoin="round" stroke="#5fb7f1" ed:parentid="105" stroke-linecap="round" d="M-13.5,2.6C-2.1,2.6,4,-2.6,13.5,-2.6" transform="matrix(1,0,0,1,1066,219)" stroke-width="2" id="112" ed:tosuperid="111" fill="none"/>
    <path stroke-linejoin="round" stroke="#5fb7f1" ed:parentid="111" stroke-linecap="round" d="M-13.5,-7.5C-1,-7.5,1.3,7.5,13.5,7.5" transform="matrix(1,0,0,1,1165,224)" stroke-width="2" id="114" ed:tosuperid="113" fill="none"/>
    <path stroke-linejoin="round" stroke="#5fb7f1" ed:parentid="111" stroke-linecap="round" d="M-13.5,37.3C4.5,37.3,-11.3,-37.3,13.5,-37.3" transform="matrix(1,0,0,1,1165,179)" stroke-width="2" id="116" ed:tosuperid="115" fill="none"/>
    <path stroke-linejoin="round" stroke="#5fb7f1" ed:parentid="111" stroke-linecap="round" d="M-13.5,14.9C0.7,14.9,-2.6,-14.9,13.5,-14.9" transform="matrix(1,0,0,1,1165,201)" stroke-width="2" id="118" ed:tosuperid="117" fill="none"/>
    <path stroke-linejoin="round" stroke="#5fb7f1" ed:parentid="117" stroke-linecap="round" d="M-13.5,7.5C-1,7.5,1.3,-7.5,13.5,-7.5" transform="matrix(1,0,0,1,1278,179)" stroke-width="2" id="120" ed:tosuperid="119" fill="none"/>
    <path stroke-linejoin="round" stroke="#5fb7f1" ed:parentid="117" stroke-linecap="round" d="M-13.5,-7.5C-1,-7.5,1.3,7.5,13.5,7.5" transform="matrix(1,0,0,1,1278,194)" stroke-width="2" id="122" ed:tosuperid="121" fill="none"/>
    <path stroke-linejoin="round" stroke="#5fb7f1" ed:parentid="111" stroke-linecap="round" d="M-13.5,-22.4C2.2,-22.4,-6.1,22.4,13.5,22.4" transform="matrix(1,0,0,1,1165,239)" stroke-width="2" id="124" ed:tosuperid="123" fill="none"/>
    <path stroke-linejoin="round" stroke="#5fb7f1" ed:parentid="111" stroke-linecap="round" d="M-13.5,-37.3C4.5,-37.3,-11.3,37.3,13.5,37.3" transform="matrix(1,0,0,1,1165,254)" stroke-width="2" id="126" ed:tosuperid="125" fill="none"/>
    <path stroke-linejoin="round" stroke="#5fb7f1" ed:parentid="125" stroke-linecap="round" d="M-13.5,0C-2.7,0,5.4,0,13.5,0" transform="matrix(1,0,0,1,1286,291)" stroke-width="2" id="130" ed:tosuperid="129" fill="none"/>
    <path stroke-linejoin="round" stroke="#80cf70" ed:parentid="101" d="M25.4,-46.3C26.2,-47.9,25.9,-49.5,24.7,-50.2C23.5,-50.9,21.8,-50.4,21,-48.8C19.9,-46.7,18.8,-44.6,17.8,-42.4C16.8,-40.3,15.8,-38.1,14.9,-35.9C14,-33.8,13.1,-31.6,12.2,-29.4C11.4,-27.2,10.6,-25,9.8,-22.8C8.9,-20.6,8.2,-18.4,7.4,-16.2C6.6,-14,5.9,-11.7,5.1,-9.5C4.4,-7.3,3.6,-5.1,2.9,-2.9C2.1,-0.7,1.4,1.5,0.6,3.7C-0.1,5.9,-0.9,8.1,-1.7,10.3C-2.5,12.5,-3.3,14.7,-4.1,16.9C-4.9,19,-5.7,21.2,-6.6,23.4C-7.4,25.5,-8.3,27.7,-9.3,29.8C-10.2,31.9,-11.1,34,-12.2,36.1C-13.2,38.2,-14.2,40.2,-15.3,42.2C-16.5,44.3,-17.6,46.3,-18.9,48.2C-20.1,50.1,-21.4,52,-22.8,53.9C-24.2,55.7,-25.7,57.5,-27.3,59.1C-28.8,60.8,-30.5,62.4,-32.2,63.9C-34,65.4,-35.8,66.7,-37.8,67.9C-39.7,69.2,-41.8,70.2,-43.9,71.1C-46,72.1,-48.1,72.8,-50.4,73.4C-52.6,74,-55,74.4,-57.2,74.7C-59.3,75,-61.2,75,-63.1,75.1C-63.5,75.1,-63.7,75.3,-63.7,75.6C-63.7,75.9,-63.5,76.1,-63.1,76.1C-61.2,76.1,-59.2,76.1,-57,75.8C-54.8,75.6,-52.4,75.2,-50,74.7C-47.7,74.1,-45.5,73.4,-43.3,72.5C-41.1,71.6,-39,70.6,-36.9,69.4C-34.9,68.2,-32.9,66.8,-31.1,65.3C-29.2,63.8,-27.5,62.2,-25.8,60.5C-24.1,58.8,-22.6,57.1,-21.1,55.2C-19.6,53.4,-18.2,51.5,-16.9,49.5C-15.6,47.5,-14.3,45.5,-13.1,43.5C-11.9,41.5,-10.8,39.4,-9.7,37.3C-8.6,35.2,-7.6,33.1,-6.6,31C-5.6,28.8,-4.7,26.7,-3.7,24.5C-2.8,22.4,-1.9,20.2,-1,18C-0.2,15.9,0.7,13.7,1.5,11.5C2.4,9.3,3.2,7.1,4,4.9C4.8,2.7,5.6,0.5,6.4,-1.6C7.2,-3.8,8,-6,8.8,-8.2C9.6,-10.4,10.5,-12.6,11.3,-14.8C12.1,-16.9,12.9,-19.1,13.8,-21.3C14.6,-23.4,15.5,-25.6,16.4,-27.7C17.3,-29.8,18.2,-32,19.1,-34.1C20.1,-36.2,21.1,-38.3,22.1,-40.3C23.2,-42.3,24.3,-44.3,25.4,-46.3z" stroke-linecap="round" transform="matrix(1,0,0,1,763,557)" id="139" ed:tosuperid="138" fill="#80cf70"/>
    <path stroke-linejoin="round" stroke="#80cf70" ed:parentid="138" stroke-linecap="round" d="M13.5,21.9C-2.1,21.9,5.8,-21.9,-13.5,-21.9" transform="matrix(1,0,0,1,571,610)" stroke-width="2" id="141" ed:tosuperid="140" fill="none"/>
    <path stroke-linejoin="round" stroke="#80cf70" ed:parentid="138" stroke-linecap="round" d="M13.5,-1.9C2.3,-1.9,-4.4,1.9,-13.5,1.9" transform="matrix(1,0,0,1,571,634)" stroke-width="2" id="143" ed:tosuperid="142" fill="none"/>
    <path stroke-linejoin="round" stroke="#80cf70" ed:parentid="138" stroke-linecap="round" d="M13.5,-16.8C-1.1,-16.8,3.5,16.8,-13.5,16.8" transform="matrix(1,0,0,1,571,649)" stroke-width="2" id="145" ed:tosuperid="144" fill="none"/>
    <path stroke-linejoin="round" stroke="#fa8556" ed:parentid="152" stroke-linecap="round" d="M13.5,10C0.4,10,0,-10,-13.5,-10" transform="matrix(1,0,0,1,587,497)" stroke-width="2" id="147" ed:tosuperid="146" fill="none"/>
    <path stroke-linejoin="round" stroke="#fa8556" ed:parentid="146" stroke-linecap="round" d="M13.5,7.5C1,7.5,-1.3,-7.5,-13.5,-7.5" transform="matrix(1,0,0,1,501,480)" stroke-width="2" id="149" ed:tosuperid="148" fill="none"/>
    <path stroke-linejoin="round" stroke="#fa8556" ed:parentid="146" stroke-linecap="round" d="M13.5,-7.5C1,-7.5,-1.3,7.5,-13.5,7.5" transform="matrix(1,0,0,1,501,495)" stroke-width="2" id="151" ed:tosuperid="150" fill="none"/>
    <path stroke-linejoin="round" stroke="#fa8556" ed:parentid="101" d="M3,0.5C4.8,0,5.5,-1.5,5.1,-2.8C4.6,-4.1,3.1,-4.8,1.4,-4.2C-0.8,-3.4,-2.9,-2.6,-5.1,-1.8C-7.3,-0.9,-9.5,-0.1,-11.7,0.7C-13.9,1.5,-16,2.3,-18.2,3.1C-20.4,3.9,-22.6,4.6,-24.8,5.4C-27,6.1,-29.2,6.8,-31.4,7.4C-33.7,8.1,-35.9,8.7,-38.2,9.2C-40.4,9.8,-42.7,10.3,-44.9,10.7C-47.2,11.1,-49.4,11.5,-51.8,11.8C-54.2,12.1,-56.8,12.3,-58.7,12.4C-60.6,12.6,-61.9,12.6,-63.1,12.7C-63.5,12.7,-63.7,12.9,-63.7,13.2C-63.7,13.4,-63.5,13.7,-63.1,13.7C-61.9,13.7,-60.6,13.7,-58.7,13.7C-56.7,13.7,-54.1,13.6,-51.6,13.4C-49.2,13.3,-46.9,13,-44.6,12.7C-42.3,12.4,-40,12.1,-37.6,11.7C-35.3,11.3,-33,10.8,-30.7,10.3C-28.4,9.7,-26.1,9.2,-23.9,8.6C-21.6,8,-19.3,7.3,-17.1,6.7C-14.8,6,-12.6,5.3,-10.3,4.7C-8.1,4,-5.9,3.3,-3.6,2.6C-1.4,1.9,0.8,1.2,3,0.5z" stroke-linecap="round" transform="matrix(1,0,0,1,763,494)" id="153" ed:tosuperid="152" fill="#fa8556"/>
    <path stroke-linejoin="round" stroke="#fa8556" ed:parentid="152" stroke-linecap="round" d="M13.5,-12.4C-0.2,-12.4,1.3,12.4,-13.5,12.4" transform="matrix(1,0,0,1,587,520)" stroke-width="2" id="155" ed:tosuperid="154" fill="none"/>
    <path stroke-linejoin="round" stroke="#fa8556" ed:parentid="154" stroke-linecap="round" d="M13.5,0C2.7,0,-5.4,0,-13.5,0" transform="matrix(1,0,0,1,514,532)" stroke-width="2" id="157" ed:tosuperid="156" fill="none"/>
    <path stroke-linejoin="round" stroke="#a98ae7" ed:parentid="101" d="M10.8,15.5C12,16.8,13.7,16.8,14.6,15.8C15.6,14.9,15.6,13.2,14.3,12C12.6,10.4,11,8.8,9.3,7.1C7.7,5.5,6.1,3.8,4.5,2.1C2.9,0.4,1.3,-1.3,-0.3,-3C-1.9,-4.7,-3.5,-6.4,-5.1,-8.1C-6.8,-9.8,-8.4,-11.4,-10.1,-13.1C-11.8,-14.7,-13.5,-16.4,-15.2,-18C-17,-19.5,-18.8,-21.1,-20.6,-22.5C-22.5,-24,-24.4,-25.4,-26.4,-26.8C-28.3,-28.1,-30.3,-29.3,-32.4,-30.5C-34.5,-31.6,-36.7,-32.6,-38.9,-33.5C-41.1,-34.4,-43.4,-35.2,-45.6,-35.8C-47.8,-36.4,-50.1,-36.9,-52.5,-37.3C-55,-37.6,-57.8,-37.8,-59.6,-37.9C-61.4,-38,-62.2,-37.9,-63.1,-37.9C-63.5,-37.9,-63.7,-37.7,-63.7,-37.4C-63.7,-37.1,-63.5,-36.9,-63.1,-36.9C-62.3,-36.9,-61.4,-36.9,-59.6,-36.7C-57.9,-36.6,-55.2,-36.3,-52.8,-35.8C-50.4,-35.4,-48.2,-34.8,-46.1,-34.1C-43.9,-33.4,-41.8,-32.6,-39.7,-31.7C-37.6,-30.7,-35.6,-29.6,-33.6,-28.4C-31.6,-27.3,-29.7,-26,-27.9,-24.6C-26,-23.3,-24.2,-21.8,-22.5,-20.3C-20.8,-18.8,-19.1,-17.2,-17.4,-15.6C-15.8,-14,-14.2,-12.3,-12.6,-10.6C-11,-8.9,-9.5,-7.2,-7.9,-5.5C-6.4,-3.8,-4.9,-2,-3.3,-0.2C-1.8,1.5,-0.3,3.3,1.2,5.1C2.8,6.8,4.3,8.6,5.9,10.3C7.5,12.1,9.1,13.8,10.8,15.5z" stroke-linecap="round" transform="matrix(1,0,0,1,763,444)" id="159" ed:tosuperid="158" fill="#a98ae7"/>
    <path stroke-linejoin="round" stroke="#a98ae7" ed:parentid="158" stroke-linecap="round" d="M13.5,10C0.4,10,0,-10,-13.5,-10" transform="matrix(1,0,0,1,587,396)" stroke-width="2" id="161" ed:tosuperid="160" fill="none"/>
    <path stroke-linejoin="round" stroke="#a98ae7" ed:parentid="158" stroke-linecap="round" d="M13.5,-4.9C1.5,-4.9,-2.7,4.9,-13.5,4.9" transform="matrix(1,0,0,1,587,411)" stroke-width="2" id="163" ed:tosuperid="162" fill="none"/>
    <path stroke-linejoin="round" stroke="#5fb7f1" ed:parentid="105" stroke-linecap="round" d="M-13.5,-49.7C5.3,-49.7,-13.4,49.7,13.5,49.7" transform="matrix(1,0,0,1,1066,271)" stroke-width="2" id="178" ed:tosuperid="177" fill="none"/>
    <path stroke-linejoin="round" stroke="#ffcd55" ed:parentid="101" d="M-17.9,19.5C-19.1,20.9,-19,22.5,-17.9,23.4C-16.8,24.3,-15.1,24.1,-14.1,22.7C-12.6,20.8,-11.2,18.9,-9.8,17C-8.4,15.1,-7,13.2,-5.7,11.2C-4.4,9.3,-3.1,7.3,-1.8,5.4C-0.5,3.4,0.8,1.5,2,-0.5C3.3,-2.4,4.6,-4.4,5.9,-6.3C7.2,-8.2,8.5,-10.1,9.8,-12C11.2,-13.9,12.5,-15.8,14,-17.6C15.4,-19.4,16.8,-21.2,18.3,-23C19.8,-24.7,21.3,-26.5,22.9,-28.1C24.6,-29.7,26.2,-31.3,28,-32.8C29.7,-34.3,31.5,-35.7,33.4,-37C35.3,-38.3,37.3,-39.4,39.3,-40.5C41.4,-41.5,43.5,-42.4,45.7,-43.2C47.8,-44,49.9,-44.6,52.3,-45.1C54.7,-45.5,57.3,-45.9,59.1,-46.1C61,-46.2,62,-46.3,63.1,-46.3C63.5,-46.3,63.7,-46.5,63.7,-46.8C63.7,-47,63.5,-47.3,63.1,-47.3C62,-47.3,61,-47.3,59.1,-47.2C57.2,-47.1,54.5,-46.8,52,-46.4C49.6,-46,47.4,-45.5,45.1,-44.8C42.9,-44.1,40.7,-43.2,38.5,-42.2C36.3,-41.2,34.3,-40.1,32.3,-38.8C30.2,-37.5,28.3,-36.1,26.4,-34.7C24.6,-33.2,22.8,-31.6,21.1,-30C19.3,-28.4,17.7,-26.7,16.1,-25C14.5,-23.2,12.9,-21.4,11.4,-19.6C9.9,-17.8,8.5,-15.9,7.1,-14.1C5.6,-12.2,4.2,-10.3,2.9,-8.4C1.5,-6.5,0.1,-4.6,-1.2,-2.7C-2.6,-0.8,-3.9,1.1,-5.3,3C-6.7,4.9,-8,6.8,-9.4,8.6C-10.8,10.5,-12.1,12.4,-13.6,14.2C-15,16,-16.5,17.7,-17.9,19.5z" stroke-linecap="round" transform="matrix(1,0,0,1,889,434)" id="181" ed:tosuperid="180" fill="#ffcd55"/>
    <path stroke-linejoin="round" stroke="#ffcd55" ed:parentid="180" stroke-linecap="round" d="M-13.5,2.5C-2.1,2.5,4,-2.5,13.5,-2.5" transform="matrix(1,0,0,1,1050,385)" stroke-width="2" id="183" ed:tosuperid="182" fill="none"/>
    <path stroke-linejoin="round" stroke="#f1a3dc" ed:parentid="101" d="M-18.9,-38.6C-19.8,-40.2,-21.5,-40.6,-22.6,-39.9C-23.8,-39.1,-24.1,-37.5,-23.2,-36C-21.9,-34,-20.7,-32.1,-19.6,-30.1C-18.4,-28.1,-17.3,-26.1,-16.3,-24C-15.2,-22,-14.2,-19.9,-13.1,-17.9C-12.1,-15.8,-11.1,-13.7,-10.1,-11.6C-9.1,-9.5,-8.2,-7.4,-7.2,-5.2C-6.2,-3.1,-5.3,-1,-4.3,1.1C-3.3,3.3,-2.3,5.4,-1.3,7.5C-0.3,9.6,0.7,11.7,1.7,13.8C2.7,15.9,3.8,18,4.8,20.1C5.9,22.2,7,24.3,8.2,26.3C9.3,28.4,10.5,30.4,11.8,32.4C13,34.4,14.3,36.4,15.6,38.3C17,40.3,18.4,42.2,19.9,44C21.4,45.8,23,47.6,24.7,49.3C26.4,51,28.1,52.6,30,54.1C31.8,55.5,33.7,56.9,35.8,58.2C37.8,59.4,39.9,60.5,42.1,61.4C44.3,62.3,46.6,63.1,48.8,63.7C51.1,64.3,53.4,64.7,55.8,65C58.2,65.2,60.6,65.3,63.1,65.4C63.5,65.4,63.7,65.1,63.7,64.9C63.7,64.6,63.5,64.4,63.1,64.3C60.7,64.2,58.3,64.1,56,63.8C53.6,63.5,51.4,63,49.2,62.3C47,61.7,44.8,60.9,42.8,59.9C40.7,59,38.7,57.9,36.7,56.6C34.8,55.4,33,54,31.2,52.5C29.5,51,27.8,49.4,26.3,47.8C24.7,46.1,23.2,44.3,21.8,42.5C20.4,40.7,19.1,38.8,17.8,36.9C16.5,35,15.3,33,14.2,31C13,29,11.9,27,10.8,24.9C9.7,22.9,8.7,20.8,7.7,18.7C6.7,16.6,5.7,14.5,4.8,12.4C3.8,10.3,2.9,8.1,1.9,6C1,3.9,0.1,1.7,-0.8,-0.4C-1.7,-2.6,-2.6,-4.7,-3.5,-6.9C-4.5,-9,-5.4,-11.2,-6.3,-13.3C-7.2,-15.5,-8.2,-17.6,-9.2,-19.7C-10.1,-21.9,-11.1,-24,-12.2,-26.1C-13.2,-28.2,-14.3,-30.4,-15.4,-32.4C-16.5,-34.5,-17.7,-36.6,-18.9,-38.6z" stroke-linecap="round" transform="matrix(1,0,0,1,889,546)" id="185" ed:tosuperid="184" fill="#f1a3dc"/>
    <path stroke-linejoin="round" stroke="#f1a3dc" ed:parentid="184" stroke-linecap="round" d="M-13.5,76C5.4,76,-13.5,-76,13.5,-76" transform="matrix(1,0,0,1,1066,535)" stroke-width="2" id="187" ed:tosuperid="186" fill="none"/>
    <path stroke-linejoin="round" stroke="#f1a3dc" ed:parentid="186" stroke-linecap="round" d="M-13.5,7.5C-1,7.5,1.3,-7.5,13.5,-7.5" transform="matrix(1,0,0,1,1165,451)" stroke-width="2" id="189" ed:tosuperid="188" fill="none"/>
    <path stroke-linejoin="round" stroke="#f1a3dc" ed:parentid="186" stroke-linecap="round" d="M-13.5,-7.5C-1,-7.5,1.3,7.5,13.5,7.5" transform="matrix(1,0,0,1,1165,466)" stroke-width="2" id="191" ed:tosuperid="190" fill="none"/>
    <path stroke-linejoin="round" stroke="#58d5d5" ed:parentid="101" d="M21,48.8C21.8,50.4,23.5,50.9,24.7,50.2C25.9,49.5,26.2,47.9,25.4,46.3C24.3,44.3,23.2,42.3,22.1,40.3C21.1,38.3,20.1,36.2,19.1,34.1C18.2,32,17.3,29.8,16.4,27.7C15.5,25.6,14.6,23.4,13.8,21.3C12.9,19.1,12.1,16.9,11.3,14.8C10.5,12.6,9.6,10.4,8.8,8.2C8,6,7.2,3.8,6.4,1.6C5.6,-0.5,4.8,-2.7,4,-4.9C3.2,-7.1,2.4,-9.3,1.5,-11.5C0.7,-13.7,-0.2,-15.9,-1,-18C-1.9,-20.2,-2.8,-22.4,-3.7,-24.5C-4.7,-26.7,-5.6,-28.8,-6.6,-31C-7.6,-33.1,-8.6,-35.2,-9.7,-37.3C-10.8,-39.4,-11.9,-41.5,-13.1,-43.5C-14.3,-45.5,-15.6,-47.5,-16.9,-49.5C-18.2,-51.5,-19.6,-53.4,-21.1,-55.2C-22.6,-57.1,-24.1,-58.8,-25.8,-60.5C-27.5,-62.2,-29.2,-63.8,-31.1,-65.3C-32.9,-66.8,-34.9,-68.2,-36.9,-69.4C-39,-70.6,-41.1,-71.6,-43.3,-72.5C-45.5,-73.4,-47.7,-74.1,-50,-74.7C-52.4,-75.2,-54.8,-75.6,-57,-75.8C-59.2,-76.1,-61.2,-76.1,-63.1,-76.1C-63.5,-76.1,-63.7,-75.9,-63.7,-75.6C-63.7,-75.3,-63.5,-75.1,-63.1,-75.1C-61.2,-75,-59.3,-75,-57.2,-74.7C-55,-74.4,-52.6,-74,-50.4,-73.4C-48.1,-72.8,-46,-72.1,-43.9,-71.1C-41.8,-70.2,-39.7,-69.2,-37.8,-67.9C-35.8,-66.7,-34,-65.4,-32.2,-63.9C-30.5,-62.4,-28.8,-60.8,-27.3,-59.1C-25.7,-57.5,-24.2,-55.7,-22.8,-53.9C-21.4,-52,-20.1,-50.1,-18.9,-48.2C-17.6,-46.3,-16.5,-44.3,-15.3,-42.2C-14.2,-40.2,-13.2,-38.2,-12.2,-36.1C-11.1,-34,-10.2,-31.9,-9.3,-29.8C-8.3,-27.7,-7.4,-25.5,-6.6,-23.4C-5.7,-21.2,-4.9,-19,-4.1,-16.9C-3.3,-14.7,-2.5,-12.5,-1.7,-10.3C-0.9,-8.1,-0.1,-5.9,0.6,-3.7C1.4,-1.5,2.1,0.7,2.9,2.9C3.6,5.1,4.4,7.3,5.1,9.5C5.9,11.7,6.6,14,7.4,16.2C8.2,18.4,8.9,20.6,9.8,22.8C10.6,25,11.4,27.2,12.2,29.4C13.1,31.6,14,33.8,14.9,35.9C15.8,38.1,16.8,40.3,17.8,42.4C18.8,44.6,19.9,46.7,21,48.8z" stroke-linecap="round" transform="matrix(1,0,0,1,763,405)" id="193" ed:tosuperid="192" fill="#58d5d5"/>
    <path stroke-linejoin="round" stroke="#58d5d5" ed:parentid="192" stroke-linecap="round" d="M13.5,2.6C2.1,2.6,-4,-2.6,-13.5,-2.6" transform="matrix(1,0,0,1,603,327)" stroke-width="2" id="195" ed:tosuperid="194" fill="none"/>
    <path stroke-linejoin="round" stroke="#f1a3dc" ed:parentid="184" stroke-linecap="round" d="M-13.5,-12.4C0.2,-12.4,-1.3,12.4,13.5,12.4" transform="matrix(1,0,0,1,1066,623)" stroke-width="2" id="205" ed:tosuperid="204" fill="none"/>
    <path stroke-linejoin="round" stroke="#f1a3dc" ed:parentid="204" stroke-linecap="round" d="M-13.5,66C5.4,66,-13.5,-66,13.5,-66" transform="matrix(1,0,0,1,1206,569)" stroke-width="2" id="207" ed:tosuperid="206" fill="none"/>
    <path stroke-linejoin="round" stroke="#f1a3dc" ed:parentid="204" stroke-linecap="round" d="M-13.5,51.8C5.4,51.8,-13.5,-51.8,13.5,-51.8" transform="matrix(1,0,0,1,1206,584)" stroke-width="2" id="209" ed:tosuperid="208" fill="none"/>
    <path stroke-linejoin="round" stroke="#f1a3dc" ed:parentid="204" stroke-linecap="round" d="M-13.5,37.7C4.5,37.7,-11.4,-37.7,13.5,-37.7" transform="matrix(1,0,0,1,1206,598)" stroke-width="2" id="211" ed:tosuperid="210" fill="none"/>
    <path stroke-linejoin="round" stroke="#f1a3dc" ed:parentid="204" stroke-linecap="round" d="M-13.5,23.6C2.4,23.6,-6.6,-23.6,13.5,-23.6" transform="matrix(1,0,0,1,1206,612)" stroke-width="2" id="213" ed:tosuperid="212" fill="none"/>
    <path stroke-linejoin="round" stroke="#f1a3dc" ed:parentid="204" stroke-linecap="round" d="M-13.5,-28.6C3.3,-28.6,-8.6,28.6,13.5,28.6" transform="matrix(1,0,0,1,1206,664)" stroke-width="2" id="215" ed:tosuperid="214" fill="none"/>
    <path stroke-linejoin="round" stroke="#f1a3dc" ed:parentid="214" stroke-linecap="round" d="M-13.5,37.3C4.5,37.3,-11.3,-37.3,13.5,-37.3" transform="matrix(1,0,0,1,1321,655)" stroke-width="2" id="217" ed:tosuperid="216" fill="none"/>
    <path stroke-linejoin="round" stroke="#f1a3dc" ed:parentid="214" stroke-linecap="round" d="M-13.5,22.4C2.2,22.4,-6.1,-22.4,13.5,-22.4" transform="matrix(1,0,0,1,1321,670)" stroke-width="2" id="219" ed:tosuperid="218" fill="none"/>
    <path stroke-linejoin="round" stroke="#f1a3dc" ed:parentid="214" stroke-linecap="round" d="M-13.5,7.5C-1,7.5,1.3,-7.5,13.5,-7.5" transform="matrix(1,0,0,1,1321,685)" stroke-width="2" id="221" ed:tosuperid="220" fill="none"/>
    <path stroke-linejoin="round" stroke="#f1a3dc" ed:parentid="214" stroke-linecap="round" d="M-13.5,-7.5C-1,-7.5,1.3,7.5,13.5,7.5" transform="matrix(1,0,0,1,1321,700)" stroke-width="2" id="223" ed:tosuperid="222" fill="none"/>
    <path stroke-linejoin="round" stroke="#f1a3dc" ed:parentid="214" stroke-linecap="round" d="M-13.5,-22.4C2.2,-22.4,-6.1,22.4,13.5,22.4" transform="matrix(1,0,0,1,1321,715)" stroke-width="2" id="225" ed:tosuperid="224" fill="none"/>
    <path stroke-linejoin="round" stroke="#f1a3dc" ed:parentid="214" stroke-linecap="round" d="M-13.5,-37.3C4.5,-37.3,-11.3,37.3,13.5,37.3" transform="matrix(1,0,0,1,1321,730)" stroke-width="2" id="227" ed:tosuperid="226" fill="none"/>
    <path stroke-linejoin="round" stroke="#6cc9e5" ed:parentid="101" d="M-30.4,-175.3C-31,-177,-32.5,-177.8,-33.8,-177.3C-35.1,-176.8,-35.7,-175.3,-35.1,-173.6C-34.3,-171.4,-33.5,-169.3,-32.8,-167.1C-32.1,-164.9,-31.5,-162.7,-30.9,-160.5C-30.3,-158.3,-29.8,-156,-29.2,-153.8C-28.7,-151.5,-28.2,-149.3,-27.8,-147C-27.3,-144.7,-26.9,-142.5,-26.5,-140.2C-26.1,-137.9,-25.7,-135.6,-25.4,-133.3C-25,-131,-24.7,-128.7,-24.4,-126.4C-24,-124.1,-23.7,-121.8,-23.5,-119.5C-23.2,-117.2,-22.9,-114.9,-22.7,-112.6C-22.4,-110.3,-22.1,-108,-21.9,-105.7C-21.7,-103.3,-21.5,-101,-21.2,-98.7C-21,-96.4,-20.8,-94.1,-20.6,-91.8C-20.4,-89.4,-20.3,-87.1,-20.1,-84.8C-19.9,-82.5,-19.7,-80.1,-19.6,-77.8C-19.4,-75.5,-19.2,-73.2,-19.1,-70.8C-18.9,-68.5,-18.8,-66.2,-18.6,-63.9C-18.5,-61.5,-18.3,-59.2,-18.2,-56.9C-18,-54.6,-17.9,-52.2,-17.8,-49.9C-17.6,-47.6,-17.5,-45.2,-17.4,-42.9C-17.2,-40.6,-17.1,-38.3,-17,-35.9C-16.8,-33.6,-16.7,-31.3,-16.6,-28.9C-16.5,-26.6,-16.3,-24.3,-16.2,-22C-16.1,-19.6,-15.9,-17.3,-15.8,-15C-15.7,-12.6,-15.5,-10.3,-15.4,-8C-15.3,-5.6,-15.1,-3.3,-15,-1C-14.9,1.3,-14.7,3.7,-14.6,6C-14.5,8.3,-14.3,10.7,-14.2,13C-14,15.3,-13.9,17.7,-13.7,20C-13.6,22.3,-13.4,24.7,-13.2,27C-13.1,29.3,-12.9,31.6,-12.7,34C-12.5,36.3,-12.4,38.6,-12.2,41C-12,43.3,-11.8,45.6,-11.6,47.9C-11.4,50.3,-11.2,52.6,-11,54.9C-10.8,57.2,-10.5,59.6,-10.3,61.9C-10.1,64.2,-9.8,66.5,-9.6,68.9C-9.3,71.2,-9,73.5,-8.8,75.8C-8.5,78.2,-8.2,80.5,-7.9,82.8C-7.6,85.1,-7.3,87.4,-7,89.8C-6.7,92.1,-6.3,94.4,-6,96.7C-5.6,99,-5.2,101.3,-4.9,103.6C-4.5,105.9,-4.1,108.2,-3.6,110.5C-3.2,112.8,-2.8,115.1,-2.3,117.4C-1.8,119.7,-1.3,122,-0.8,124.3C-0.3,126.6,0.2,128.8,0.8,131.1C1.4,133.4,2,135.7,2.6,137.9C3.2,140.2,3.9,142.4,4.6,144.7C5.3,146.9,6,149.1,6.8,151.3C7.6,153.5,8.4,155.7,9.3,157.9C10.2,160.1,11.1,162.2,12.1,164.4C13.1,166.5,14.1,168.6,15.3,170.7C16.4,172.7,17.6,174.8,18.8,176.8C20.1,178.8,21.4,180.7,22.9,182.6C24.3,184.4,25.8,186.2,27.4,187.9C29.1,189.7,30.8,191.3,32.6,192.8C34.4,194.3,36.4,195.6,38.4,196.9C40.4,198.1,42.6,199.2,44.7,200C46.9,200.9,49.1,201.7,51.5,202.2C53.9,202.7,56.5,203.1,58.5,203.3C60.4,203.5,61.8,203.5,63.1,203.5C63.5,203.5,63.7,203.2,63.7,203C63.7,202.7,63.5,202.5,63.1,202.5C61.8,202.5,60.5,202.4,58.6,202.2C56.6,202,54.1,201.7,51.7,201.1C49.4,200.6,47.3,199.8,45.2,199C43.1,198.1,41,197,39.1,195.8C37.1,194.6,35.2,193.2,33.5,191.8C31.7,190.3,30,188.7,28.5,187C26.9,185.3,25.4,183.5,24,181.7C22.6,179.8,21.3,177.9,20.1,176C18.9,174,17.7,172,16.7,169.9C15.6,167.9,14.6,165.8,13.6,163.7C12.7,161.6,11.8,159.4,10.9,157.3C10.1,155.1,9.3,152.9,8.5,150.7C7.8,148.5,7.1,146.3,6.4,144.1C5.7,141.9,5.1,139.6,4.5,137.4C3.9,135.2,3.3,132.9,2.8,130.6C2.2,128.4,1.7,126.1,1.2,123.8C0.7,121.6,0.2,119.3,-0.2,117C-0.6,114.7,-1.1,112.4,-1.5,110.1C-1.9,107.8,-2.2,105.6,-2.6,103.3C-3,101,-3.3,98.7,-3.7,96.3C-4,94,-4.3,91.7,-4.6,89.4C-4.9,87.1,-5.2,84.8,-5.5,82.5C-5.7,80.2,-6,77.9,-6.2,75.6C-6.5,73.2,-6.7,70.9,-7,68.6C-7.2,66.3,-7.4,64,-7.6,61.6C-7.8,59.3,-8,57,-8.2,54.7C-8.4,52.4,-8.6,50,-8.8,47.7C-9,45.4,-9.1,43.1,-9.3,40.7C-9.5,38.4,-9.6,36.1,-9.8,33.8C-9.9,31.4,-10.1,29.1,-10.2,26.8C-10.4,24.5,-10.5,22.1,-10.6,19.8C-10.8,17.5,-10.9,15.1,-11,12.8C-11.1,10.5,-11.3,8.2,-11.4,5.8C-11.5,3.5,-11.6,1.2,-11.7,-1.2C-11.8,-3.5,-11.9,-5.8,-12.1,-8.1C-12.2,-10.5,-12.3,-12.8,-12.4,-15.1C-12.5,-17.5,-12.6,-19.8,-12.7,-22.1C-12.8,-24.5,-12.9,-26.8,-13,-29.1C-13.1,-31.5,-13.2,-33.8,-13.3,-36.1C-13.4,-38.4,-13.6,-40.8,-13.7,-43.1C-13.8,-45.4,-13.9,-47.8,-14,-50.1C-14.1,-52.4,-14.2,-54.8,-14.3,-57.1C-14.5,-59.4,-14.6,-61.8,-14.7,-64.1C-14.8,-66.4,-15,-68.8,-15.1,-71.1C-15.2,-73.4,-15.4,-75.8,-15.5,-78.1C-15.7,-80.4,-15.8,-82.8,-16,-85.1C-16.1,-87.4,-16.3,-89.8,-16.5,-92.1C-16.6,-94.4,-16.8,-96.7,-17,-99.1C-17.2,-101.4,-17.4,-103.7,-17.6,-106.1C-17.8,-108.4,-18.1,-110.7,-18.3,-113.1C-18.5,-115.4,-18.8,-117.7,-19,-120C-19.3,-122.4,-19.6,-124.7,-19.9,-127C-20.2,-129.4,-20.5,-131.7,-20.8,-134C-21.2,-136.3,-21.5,-138.6,-21.9,-141C-22.3,-143.3,-22.7,-145.6,-23.1,-147.9C-23.6,-150.2,-24,-152.5,-24.6,-154.8C-25.1,-157.1,-25.6,-159.4,-26.2,-161.7C-26.8,-164,-27.4,-166.3,-28.1,-168.6C-28.8,-170.8,-29.6,-173.1,-30.4,-175.3z" stroke-linecap="round" transform="matrix(1,0,0,1,889,684)" id="229" ed:tosuperid="228" fill="#6cc9e5"/>
    <path stroke-linejoin="round" stroke="#6cc9e5" ed:parentid="228" stroke-linecap="round" d="M-13.5,31.6C3.7,31.6,-9.6,-31.6,13.5,-31.6" transform="matrix(1,0,0,1,1082,855)" stroke-width="2" id="233" ed:tosuperid="232" fill="none"/>
    <path stroke-linejoin="round" stroke="#6cc9e5" ed:parentid="228" stroke-linecap="round" d="M-13.5,-4.9C-1.5,-4.9,2.7,4.9,13.5,4.9" transform="matrix(1,0,0,1,1082,892)" stroke-width="2" id="235" ed:tosuperid="234" fill="none"/>
    <path stroke-linejoin="round" stroke="#6cc9e5" ed:parentid="234" stroke-linecap="round" d="M-13.5,22.4C2.2,22.4,-6.1,-22.4,13.5,-22.4" transform="matrix(1,0,0,1,1181,874)" stroke-width="2" id="237" ed:tosuperid="236" fill="none"/>
    <path stroke-linejoin="round" stroke="#6cc9e5" ed:parentid="234" stroke-linecap="round" d="M-13.5,8.3C-0.8,8.3,0.9,-8.3,13.5,-8.3" transform="matrix(1,0,0,1,1181,888)" stroke-width="2" id="239" ed:tosuperid="238" fill="none"/>
    <path stroke-linejoin="round" stroke="#6cc9e5" ed:parentid="234" stroke-linecap="round" d="M-13.5,-14.1C0.5,-14.1,-2.1,14.1,13.5,14.1" transform="matrix(1,0,0,1,1181,911)" stroke-width="2" id="241" ed:tosuperid="240" fill="none"/>
    <path stroke-linejoin="round" stroke="#6cc9e5" ed:parentid="240" stroke-linecap="round" d="M-13.5,7.5C-1,7.5,1.3,-7.5,13.5,-7.5" transform="matrix(1,0,0,1,1254,917)" stroke-width="2" id="243" ed:tosuperid="242" fill="none"/>
    <path stroke-linejoin="round" stroke="#6cc9e5" ed:parentid="240" stroke-linecap="round" d="M-13.5,-7.5C-1,-7.5,1.3,7.5,13.5,7.5" transform="matrix(1,0,0,1,1254,932)" stroke-width="2" id="245" ed:tosuperid="244" fill="none"/>
    <g ed:topictype="mainidea" ed:layout="map" transform="matrix(1,0,0,1,763,452)" ed:width="126.4" ed:height="57" id="101">
        <path stroke-linejoin="round" stroke="#ffffff" d="M28.5,0L97.9,0C113.6,0,126.4,12.8,126.4,28.5C126.4,44.2,113.6,57,97.9,57L28.5,57C12.8,57,0,44.2,0,28.5C0,12.8,12.8,0,28.5,0z" stroke-width="4" fill="#ffffff"/>
        <text class="st46">
            <tspan y="35.1" x="25" style="white-space:pre">其他问题</tspan>
        </text>
    </g>
    <g ed:layout="rightmap" ed:parentid="101" transform="matrix(1,0,0,1,952,22)" ed:width="115.4" ed:height="33.55" id="102">
        <path stroke-linejoin="round" stroke="#ff7575" d="M0,33.5L115.4,33.5" stroke-width="2" fill="none"/>
        <text class="st47">
            <tspan y="22.3" x="17" style="white-space:pre">UML类图</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>UML类图中类之间的关系包括：&lt;/span>&lt;/p>&lt;ul style=&quot;margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;&quot;>&lt;li style=&quot; font-family:'Consolas'; font-size:11pt;&quot; style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>依赖：A类是B类中某方法的局部变量；A类是B类方法的其中一个参数；A类向B类发送消息，从而影响B类发生变化。&lt;/li>&lt;li style=&quot; font-family:'Consolas'; font-size:11pt;&quot; style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>泛化：继承关系&lt;/li>&lt;li style=&quot; font-family:'Consolas'; font-size:11pt;&quot; style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>实现：实现接口。&lt;/li>&lt;li style=&quot; font-family:'Consolas'; font-size:11pt;&quot; style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>关联：类之间的联系。&lt;span style=&quot; background-color:#ffff00;&quot;>通常是将一个类的对象作为另一个类的属性。&lt;/span>&lt;/li>&lt;li style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffffff;&quot; style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>聚合：表示整体与部分的关系。成员是整体的一部分，但成员可以脱离整体对象独立存在。&lt;/li>&lt;li style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffffff;&quot; style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>组合：整体与部分，但是整体与部分不能分开。&lt;span style=&quot; background-color:#ffff00;&quot;>实心菱形箭头。&lt;/span>&lt;/li>&lt;/ul>&lt;/body>">
            <use transform="translate(83,9)" xlink:href="#note"/>
        </g>
    </g>
    <symbol id="note">
        <image height="16" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADtUlEQVRYCcVXS0gWURQ+d+Z/qJWPiEot0ohQc6GbHkSZFb0spHbRTmjVQlyEWuuokIiIVkVERLUrSMpa9A4fYFSLJIyyh1omqOXrH/+Z6Zzj3GGc/8HM309e+OfcOXPO+b577r3nv1dAkmaaZj5+Lkhi4uXTgBBi0Ish2yCoir8m/PXjL12NYlFM1U1EOBWWwSNz6sf2mTdnQf/ZCebUkNPEd19kLgV12QYIVjSCyFz+GAPswozoMpCbQBOCn55+sB/MyKi0SYsU4VzI2NtKJJqRwBkZ1E2gX2tvKIj23QO1oApC60+RA9tO3lojfTzJrMMf2Q4HBFrXSdAHnkGg6ACENp2nNVEogyiyg+nnBUdpp+YElzapSBoAxaJmxS6wsFhnE8A3Xu1yzuXI2QofShbx89bcthxLzXCuJ3tnOQkkjU6jcAeO50A2csRgaGAMdwOYBoSrrwEEsmJcAjGaBAolfytk1L5I8DWOOjoBkad1oP/qhsDKPRDafAHC267GGHrOQIxnMoUDnMyi39pAe1UP6pJK6ZUpO+knoI3A9MODPHJlQSGEt1wCEcq2SYDJJeAiLsSFRCK9BHDkk607wfj9CUFzILzjJqgrduP8X3eTqEDs2+klYKUdImMUF0xtDPSv97mvLC6fQ2Lm3TnS12AWStOTAcecU9pDlc0ghAIalvNoz2UmQTuCdgM3JTgrAQzPu0B6xEgXOKVdIAkRzgOts4lJGBP9oPfdBXNmHKthLQTL6ynMHayIH/6NQAJwiq4WH4IQykhHI0R7b5CKwUMbWwCE0oWvR0iX+hQkAafA1MSiIhBqmPtK9mqwwOm9AUc/RZ3UCHgAN4ZfcyEy9WlQqYjta8P/gg7CpBaZFakQMKN2heN9bs25DEjSBrfmPFx1hcEjz486zbjvOwPG4MvZIoM1Xy44Z1Q3uEw7g+v2wG0X/wRG37OzuqqGV7sdCTuJwNkmDjjp/RMY6eF4Sm4JS/lICi6N4kjf29CQBPLKZsPhPOtD7aC1H7f3uUx7HLwYlT8C0Ukwx79wEO1tC5hjvWCMf7eDUpHxA06OvgiYfz4D1m8G1PufsBSBDFBy1uIZshoC645RkWG914cvAgKBgiV1uHICoOSWgZJXisWm2Deok5yTwAB9oHM8nQvpNOs+FwL+iQQrTzj9PfUpFjWKbTXGor6dLyyNdH0aoEsENTpKS0dWpPiQx3Jyt2LPuaq57wXzfjGhu9t/vZrFJBZX+fxdTt1skAzfltx6n+9z5tzt+xdJwGKygJ8cdgAAAABJRU5ErkJggg==" width="16"/>
    </symbol>
    <g ed:layout="rightmap" ed:parentid="101" transform="matrix(1,0,0,1,952,188)" ed:width="100" ed:height="33.55" id="105">
        <path stroke-linejoin="round" stroke="#5fb7f1" d="M0,33.5L100,33.5" stroke-width="2" fill="none"/>
        <text class="st47">
            <tspan y="22.3" x="17" style="white-space:pre">算法问题</tspan>
        </text>
    </g>
    <g ed:layout="rightmap" ed:parentid="105" transform="matrix(1,0,0,1,1079,89)" ed:width="107" ed:height="23.35" id="107">
        <path stroke-linejoin="round" stroke="#5fb7f1" d="M0,23.4L107,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">求解平方根</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; color:#ff0000;&quot;>1. 牛顿迭代法&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>根据公式Xn+1 = Xn - f(Xn)/f'(Xn)&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>在平方根求解中可以将f(x) = x^2 - a， 所以Xn+1 = (Xn + a/Xn)/2，不断迭代，直到一次迭代前后差值小于1e6.&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(81,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="105" transform="matrix(1,0,0,1,1079,193)" ed:width="72.40000000000001" ed:height="23.35" id="111">
        <path stroke-linejoin="round" stroke="#5fb7f1" d="M0,23.4L72.4,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">背包九讲</tspan>
        </text>
    </g>
    <g ed:layout="rightmap" ed:parentid="111" transform="matrix(1,0,0,1,1179,208)" ed:width="87.8" ed:height="23.35" id="113">
        <path stroke-linejoin="round" stroke="#5fb7f1" d="M0,23.4L87.8,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">0/1背包</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffff00;&quot;>F[i, v]表示前i件物品放入一个容量为v的背包可以获得的最大价值。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>状态转移方程为:&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>&#x9;&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>F[i, v] = max{F[i-1, v], F[i-1, v-Ci] + Wi}&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>比如对于3件物品，消耗容量分别为1, 2, 3；价值分别为3, 4, 4， 给定的背包容量为5&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>构建的dp如下：&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>0 0 0 0 0 0&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>0 3 3 3 3 3&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>0 3 4 7 7 7&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>0 3 4 7 7 8&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>时间复杂度和空间复杂度均为O(VN)，&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffff00;&quot;>空间复杂度可继续优化到O(V),其实就是滚动数组，因为当前行的处理结果只与上一行的值有关（在优化时需要从右向左处理）&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffffff;&quot;>这边还有小优化点，也就是V-&amp;gt;C[i]，都可以进行比较，C[i] -&amp;gt; 1都直接原数据。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(62,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="111" transform="matrix(1,0,0,1,1179,118)" ed:width="93.40000000000001" ed:height="23.35" id="115">
        <path stroke-linejoin="round" stroke="#5fb7f1" d="M0,23.4L93.4,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">问题背景</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>有N件物品和一个容量V的背包。放入第i件物品耗费的费用是Ci，得到的价值是Wi。求解将哪些物品装入背包可使价值总和最大。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(68,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="111" transform="matrix(1,0,0,1,1179,163)" ed:width="86" ed:height="23.35" id="117">
        <path stroke-linejoin="round" stroke="#5fb7f1" d="M0,23.4L86,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">初始化细节</tspan>
        </text>
    </g>
    <g ed:layout="rightmap" ed:parentid="117" transform="matrix(1,0,0,1,1292,148)" ed:width="120.6" ed:height="23.35" id="119">
        <path stroke-linejoin="round" stroke="#5fb7f1" d="M0,23.4L120.6,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">恰好装满背包</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>在初始化时除了 F[0] 为 0，其它 F[1..V ] 均设为 −∞，这样就可以保证最终得到的 F[V ] 是一种恰好装满背包的最优解。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(95,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="117" transform="matrix(1,0,0,1,1292,178)" ed:width="134.2" ed:height="23.35" id="121">
        <path stroke-linejoin="round" stroke="#5fb7f1" d="M0,23.4L134.2,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">不要求装满背包</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>F[0, 0...V]都置为0就可以。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(108,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="111" transform="matrix(1,0,0,1,1179,238)" ed:width="93.40000000000001" ed:height="23.35" id="123">
        <path stroke-linejoin="round" stroke="#5fb7f1" d="M0,23.4L93.4,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">完全背包</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>完全背包的不同之处在于每种物品都有无限件可用。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>状态方程为&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>&#x9;&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>F[i, v] = max{F[i-1, v-kCi] + kWi | 0 &amp;lt;= kCi &amp;lt;= v}&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>此时求解每个状态的时间已经不是常数了，求解F[i, v]的时间是O(v/Ci)，总的复杂度可以认为是&lt;/span>&lt;span style=&quot; font-size:11pt;&quot;>O(NV ΣV/Ci),是比较大的。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>1. 完全背包问题有一个很简单有效的优化，是这样的：若两件物品 i、j 满足 Ci ≤ Cj 且 Wi ≥ Wj，则将可以将物品 j 直接去掉，不用考虑。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>2. 更高效的转化方法是：把第 i 种物品拆成费用为 Ci2 k、价值为 Wi2 k 的若干件物 品，其中 k 取遍满足 Ci2 k ≤ V 的非负整数。 这是二进制的思想。因为，不管最优策略选几件第 i 种物品，其件数写成二进制后， 总可以表示成若干个 2 k 件物品的和。这样一来就把每种物品拆成 O(log ⌊V /Ci⌋) 件物 品，是一个很大的改进。&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffff00;&quot;>其实就是压缩dp的行，压缩物品的数量，转化为0/1背包问题&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffffff;&quot;>3. &lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000; background-color:#ffffff;&quot;>O(VN)的算法（最棒）&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>F[0..V ] ←0&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>for i ← 1 to N&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>&#x9;for v ← Ci to V&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>&#x9;&#x9;F[v] ← max(F[v], F[v − Ci ] + Wi)&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>这思路更好，建立在之前的基础上。着重注意的是v从Ci到V递增，然后求相应状态。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(68,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="111" transform="matrix(1,0,0,1,1179,268)" ed:width="93.40000000000001" ed:height="23.35" id="125">
        <path stroke-linejoin="round" stroke="#5fb7f1" d="M0,23.4L93.4,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">多重背包</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>有 N 种物品和一个容量为 V 的背包。第 i 种物品最多有 Mi 件可用，每件耗费的 空间是 Ci，价值是 Wi。求解将哪些物品装入背包可使这些物品的耗费的空间总和不超 过背包容量，且价值总和最大。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; color:#ff0000; background-color:#ffff00;&quot;>方法&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>是：将第 i 种物品分成若干件 01 背包中的物品，其中每件物品有一个系 数。这件物品的费用和价值均是原来的费用和价值乘以这个系数。令这些系数分别为 1, 2, 2^2 . . . 2^k−1 , Mi − 2^k + 1，且 k 是满足 Mi − 2^k + 1 &amp;gt; 0 的最大整数。例如，如果 Mi 为 13，则相应的 k = 3，这种最多取 13 件的物品应被分成系数分别为 1, 2, 4, 6 的四件物品。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(68,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="125" transform="matrix(1,0,0,1,1299,268)" ed:width="311" ed:height="23.35" id="129">
        <path stroke-linejoin="round" stroke="#5fb7f1" d="M0,23.4L311,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">每种有若干件的物品能否填满给定容量的背包</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>下面介绍一种实现较为简单的 O(VN) 复杂度解多重背包问题的算法。它的基本 思想是这样的：设 F[i, j] 表示“用了前i种物品填满容量为j的背包后，最多还剩下几个第i种物品可用”，如果F[i, j] = −1 则说明这种状态不可行，若可行应满足 0 ≤ F[i, j] ≤ Mi。 递推求 F[i, j] 的伪代码如下： &lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>F[0, 1 . . . V ] ← −1 &lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>F[0, 0] ← 0 &lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>for i ← 1 to N &lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>&#x9;for j ← 0 to V &lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>&#x9;&#x9;if F[i − 1][j] ≥ 0 &lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>&#x9;&#x9;&#x9;F[i][j] = Mi &lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>&#x9;&#x9;else &lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>&#x9;&#x9;&#x9;F[i][j] = −1&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>&#x9;for j ← 0 to V − Ci&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>&#x9;&#x9;if F[i][j] &amp;gt; 0 &lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>&#x9;&#x9;&#x9;F[i][j + Ci ] ← max{F[i][j + Ci ], F[i][j] − 1} &lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>最终 F[N][0 . . . V ] 便是多重背包可行性问题的答案。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(285,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="leftmap" ed:parentid="101" transform="matrix(1,0,0,1,584,599)" ed:width="116" ed:height="33.55" id="138">
        <path stroke-linejoin="round" stroke="#80cf70" d="M0,33.5L116,33.5" stroke-width="2" fill="none"/>
        <text class="st47">
            <tspan y="22.3" x="17" style="white-space:pre">海量数据题</tspan>
        </text>
    </g>
    <g ed:layout="leftmap" ed:parentid="138" transform="matrix(1,0,0,1,218,565)" ed:width="339" ed:height="23.35" id="140">
        <path stroke-linejoin="round" stroke="#80cf70" d="M0,23.4L339,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">海量日志数据，提取出某日访问百度次数最多的IP</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>1. 对IP进行&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffff00;&quot;>映射处理（hash）&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>，比如mod1000，分成1000个文件。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>2. 分别找出每个文件访问次数最高的ip。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>3. 然后再对比这1000个“最大”的IP&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(313,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="leftmap" ed:parentid="138" transform="matrix(1,0,0,1,22,595)" ed:width="535" ed:height="40.95" id="142">
        <path stroke-linejoin="round" stroke="#80cf70" d="M0,41L535,41" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">1G大小的文件，里面每一行是一个词，词的大小不超过16字节，内存限制大小为</tspan>
            <tspan y="33.9" x="8" style="white-space:pre">1M，返回频数最高的100个词。</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>方案：&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>1. 顺序读文件中，对于每个词x，取hash(x)%5000，然后按照该值存到5000个小文件（记为x0,x1,...x4999）中。这样每个文件大概是200k左右。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>2. 如果其中的有的文件超过了1M大小，&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffff00;&quot;>还可以按照类似的方法继续往下分，直到分解得到的小文件的大小都不超过1M&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>3. 对每个小文件，统计每个文件中出现的词以及相应的频率（可以采用trie树/hash_map等），并取出出现频率最大的100个词（可以用含100个结点的最小堆），并把100个词及相应的频率存入文件，这样又得到了5000个文件。下一步就是把这5000个文件进行归并（类似与归并排序）的过程了。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(509,12)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="leftmap" ed:parentid="138" transform="matrix(1,0,0,1,121,642)" ed:width="435.8" ed:height="23.35" id="144">
        <path stroke-linejoin="round" stroke="#80cf70" d="M0,23.4L435.8,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">在2.5亿整数中找出不重复的整数，内存不足以容纳这2.5亿个整数</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>所有整数的个数为2^32，每个用2bit来表示，00表示不存在，01表示存在1次，10表示存在多次。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>这样需要的内存容量为2^32*2 = 1GB&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(410,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="leftmap" ed:parentid="152" transform="matrix(1,0,0,1,514,464)" ed:width="58.8" ed:height="23.35" id="146">
        <path stroke-linejoin="round" stroke="#fa8556" d="M0,23.4L58.8,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">平衡树</tspan>
        </text>
    </g>
    <g ed:layout="leftmap" ed:parentid="146" transform="matrix(1,0,0,1,407,449)" ed:width="79.8" ed:height="23.35" id="148">
        <path stroke-linejoin="round" stroke="#fa8556" d="M0,23.4L79.8,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">红黑树</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>红黑树不追求完全平衡，是功能、性能、空间开销的折中结果。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>读取略逊于AVL，维护强于AVL，空间开销与AVL类似。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(54,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="leftmap" ed:parentid="146" transform="matrix(1,0,0,1,413,479)" ed:width="74.2" ed:height="23.35" id="150">
        <path stroke-linejoin="round" stroke="#fa8556" d="M0,23.4L74.2,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">AVL树</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>追求完全平衡，在增加或者删除节点的时候，根据不同情况，旋转的次数比红黑树要多。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>AVL在插入和删除时效率低，查询效率高。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(48,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="leftmap" ed:parentid="101" transform="matrix(1,0,0,1,600,474)" ed:width="100" ed:height="33.55" id="152">
        <path stroke-linejoin="round" stroke="#fa8556" d="M0,33.5L100,33.5" stroke-width="2" fill="none"/>
        <text class="st47">
            <tspan y="22.3" x="17" style="white-space:pre">数据结构</tspan>
        </text>
    </g>
    <g ed:layout="leftmap" ed:parentid="152" transform="matrix(1,0,0,1,528,509)" ed:width="45.2" ed:height="23.35" id="154">
        <path stroke-linejoin="round" stroke="#fa8556" d="M0,23.4L45.2,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">排序</tspan>
        </text>
    </g>
    <g ed:layout="leftmap" ed:parentid="154" transform="matrix(1,0,0,1,456,509)" ed:width="45.2" ed:height="23.35" id="156">
        <path stroke-linejoin="round" stroke="#fa8556" d="M0,23.4L45.2,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">快排</tspan>
        </text>
    </g>
    <g ed:layout="leftmap" ed:parentid="101" transform="matrix(1,0,0,1,600,373)" ed:width="100" ed:height="33.55" id="158">
        <path stroke-linejoin="round" stroke="#a98ae7" d="M0,33.5L100,33.5" stroke-width="2" fill="none"/>
        <text class="st47">
            <tspan y="22.3" x="17" style="white-space:pre">设计模式</tspan>
        </text>
    </g>
    <g ed:layout="leftmap" ed:parentid="158" transform="matrix(1,0,0,1,344,363)" ed:width="229.4" ed:height="23.35" id="160">
        <path stroke-linejoin="round" stroke="#a98ae7" d="M0,23.4L229.4,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">简单工厂、工厂方法和抽象方法</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>1. 简单工厂&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>通过静态方法实现，通过接收的参数的不同来返回不同的对象实例（属于同一接口）。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>2. 工厂方法&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>每种产品对应一个工厂类（每个工厂生产一类产品），通过不同的工厂实例来创建不同的产品实例。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>3. 抽象工厂&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>每一个工厂生产一整个产品组，比如汽车公司要生产轿车、货车和客车。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(204,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="leftmap" ed:parentid="158" transform="matrix(1,0,0,1,507,393)" ed:width="66.2" ed:height="23.35" id="162">
        <path stroke-linejoin="round" stroke="#a98ae7" d="M0,23.4L66.2,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">原则</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>1. 单一职责原则&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>一个类只负责一项职责。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>2. 里氏替换原则&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>所有引用基类的地方必须能够透明地使用其子类对象。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>3. 依赖倒置原则&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>高层模块不应该依赖底层模块，二者都应该依赖抽象。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>抽象不应该依赖细节；细节依赖于抽象。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>4. 接口隔离原则&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>客户端不应该依赖它不需要的接口；&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffff00;&quot;>一个类对另一个类的依赖应该建立在最小的接口上&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>5. 迪米特原则&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>一个类应该和其他类保持最少的了解。（降低类之间耦合）&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>6. 开闭原则&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>一个软件实体如类、模块和函数应该对扩展开放，对修改关闭。当软件需要变化时，尽量通过扩展软件实体的行为来实现变化，而不是通过修改已有的代码来实现变化。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(40,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="105" transform="matrix(1,0,0,1,1079,298)" ed:width="93.40000000000001" ed:height="23.35" id="177">
        <path stroke-linejoin="round" stroke="#5fb7f1" d="M0,23.4L93.4,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">股票问题</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>1. 状态描述&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>三维状态dp[i][k][0] or dp[i][k][1]&lt;/span>&lt;/p>&lt;ul style=&quot;margin-top: 0px; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; -qt-list-indent: 1;&quot;>&lt;li style=&quot; font-family:'Consolas'; font-size:11pt;&quot; style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>dp[i][k][0]：表示在第i天，此时未持有股票，并已经进行了k次交易。&lt;/li>&lt;li style=&quot; font-family:'Consolas'; font-size:11pt;&quot; style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>dp[i][k][1]：表示在第i天，此时持有股票，并已经进行了k次交易。&lt;/li>&lt;/ul>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>2. 状态转移方程&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>dp[i][k][0] = max(dp[i-1][k][0], dp[i-1][k][1] + prices[i])&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>                  &lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffff00;&quot;>表示啥都不干 &lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>   &lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffff00;&quot;>表示在第i天卖出手里的股票&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>dp[i][k][1] = max(dp[i-1][k][1], dp[i-1][k-1][0] - prices[i])&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffff00;&quot;>表示啥也不干&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>    &lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffff00;&quot;>表示在第i天买入股票&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffffff;&quot;>注意：在买入股票时，交易数k + 1&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(68,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="101" transform="matrix(1,0,0,1,952,354)" ed:width="84" ed:height="33.55" id="180">
        <path stroke-linejoin="round" stroke="#ffcd55" d="M0,33.5L84,33.5" stroke-width="2" fill="none"/>
        <text class="st47">
            <tspan y="22.3" x="17" style="white-space:pre">数据库</tspan>
        </text>
    </g>
    <g ed:layout="rightmap" ed:parentid="180" transform="matrix(1,0,0,1,1063,359)" ed:width="270.2" ed:height="23.35" id="182">
        <path stroke-linejoin="round" stroke="#ffcd55" d="M0,23.4L270.2,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">关系型数据库与非关系型数据库的差异</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>两者的主要差异在于数据存储的方式。关系型数据天然就是表格式的，因此存储在数据表的行和列中。数据表可以彼此关联协作存储，也很容易提取数据。与其相反，非关系型数据不适合存储在数据表的行和列中。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(244,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="101" transform="matrix(1,0,0,1,952,577)" ed:width="100" ed:height="33.55" id="184">
        <path stroke-linejoin="round" stroke="#f1a3dc" d="M0,33.5L100,33.5" stroke-width="2" fill="none"/>
        <text class="st47">
            <tspan y="22.3" x="17" style="white-space:pre">负载均衡</tspan>
        </text>
    </g>
    <g ed:layout="rightmap" ed:parentid="184" transform="matrix(1,0,0,1,1079,435)" ed:width="72.40000000000001" ed:height="23.35" id="186">
        <path stroke-linejoin="round" stroke="#f1a3dc" d="M0,23.4L72.4,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">限流算法</tspan>
        </text>
    </g>
    <g ed:layout="rightmap" ed:parentid="186" transform="matrix(1,0,0,1,1179,420)" ed:width="66.2" ed:height="23.35" id="188">
        <path stroke-linejoin="round" stroke="#f1a3dc" d="M0,23.4L66.2,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">漏桶</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>在网络中，漏桶算法可以控制端口的流量输出速率，平滑网络上的突发流量，实现流量整形，从而为网络提供一个稳定的流量。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>把请求比作是水，水来了都先放进桶里，并以限定的速度出水，当水来得过猛而出水不够快时就会导致水直接溢出，即拒绝服务。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(40,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="186" transform="matrix(1,0,0,1,1179,450)" ed:width="79.8" ed:height="23.35" id="190">
        <path stroke-linejoin="round" stroke="#f1a3dc" d="M0,23.4L79.8,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">令牌桶</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>令牌桶算法的原理是系统会以一个恒定的速度往桶里放入令牌，而如果请求需要被处理，则需要先从桶里获取一个令牌，当桶里没有令牌可取时，则拒绝服务。从原理上看，令牌桶算法和漏桶算法是相反的，一个“进水”，一个是“漏水”。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(54,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="leftmap" ed:parentid="101" transform="matrix(1,0,0,1,616,296)" ed:width="84" ed:height="33.55" id="192">
        <path stroke-linejoin="round" stroke="#58d5d5" d="M0,33.5L84,33.5" stroke-width="2" fill="none"/>
        <text class="st47">
            <tspan y="22.3" x="17" style="white-space:pre">趣味题</tspan>
        </text>
    </g>
    <g ed:layout="leftmap" ed:parentid="192" transform="matrix(1,0,0,1,496,301)" ed:width="93.40000000000001" ed:height="23.35" id="194">
        <path stroke-linejoin="round" stroke="#58d5d5" d="M0,23.4L93.4,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">微信红包</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>public static double getRandomMoney(LeftMoneyPackage _leftMoneyPackage) {&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>    // remainSize 剩余的红包数量&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>    // remainMoney 剩余的钱&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>    if (_leftMoneyPackage.remainSize == 1) {&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>        _leftMoneyPackage.remainSize--;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>        return (double) Math.round(_leftMoneyPackage.remainMoney * 100) / 100;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>    }&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>    Random r     = new Random();&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>    double min   = 0.01; //&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>    double max   = _leftMoneyPackage.remainMoney / _leftMoneyPackage.remainSize * 2;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>    double money = r.nextDouble() * max;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>    money = money  min ? 0.01: money;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>    money = Math.floor(money * 100) / 100;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>    _leftMoneyPackage.remainSize--;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>    _leftMoneyPackage.remainMoney -= money;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>    return money;&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>}&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(68,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="184" transform="matrix(1,0,0,1,1079,612)" ed:width="113.2" ed:height="23.35" id="204">
        <path stroke-linejoin="round" stroke="#f1a3dc" d="M0,23.4L113.2,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">企业级负载均衡</tspan>
        </text>
    </g>
    <g ed:layout="rightmap" ed:parentid="204" transform="matrix(1,0,0,1,1220,480)" ed:width="107.8" ed:height="23.35" id="206">
        <path stroke-linejoin="round" stroke="#f1a3dc" d="M0,23.4L107.8,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">DR三角传输</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>1. 通过修改数据包的目的Mac地址使流量经过二层转发到达应用服务器。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>2. 应用服务器处理完成后直接将响应发送给客户端。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>优点：&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>1. 应用直接将应答发送给客户端，性能好&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>缺点：&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>1. 应用服务器必须和负载均衡服务器位于同一个二层局域网。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>2. 应有服务器必须配置VIP&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(82,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="204" transform="matrix(1,0,0,1,1220,510)" ed:width="103.8" ed:height="21.75" id="208">
        <path stroke-linejoin="round" stroke="#f1a3dc" d="M0,21.8L103.8,21.8" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="14.7" x="8" style="white-space:pre">NAT(DNAT)</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>NAT通过修改数据包的目的IP，从而让流量到达应用服务器。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>优点：&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>1. 应用服务器无需做任何配置&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>缺点：&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>1. 负载均衡必须以网关形式存在&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(78,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="204" transform="matrix(1,0,0,1,1220,538)" ed:width="82.2" ed:height="21.75" id="210">
        <path stroke-linejoin="round" stroke="#f1a3dc" d="M0,21.8L82.2,21.8" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="14.7" x="8" style="white-space:pre">Tunnel</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>Tunnel类似DR模式&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>优点：&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>1. 和DR一样，应用直接将应答发送给客户端，性能好&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>缺点：&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>1. 对应用服务器要求高，需要支持tunnel&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>2. 应用服务器需要配置vip。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(56,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="204" transform="matrix(1,0,0,1,1220,566)" ed:width="168.6" ed:height="21.75" id="212">
        <path stroke-linejoin="round" stroke="#f1a3dc" d="M0,21.8L168.6,21.8" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="14.7" x="8" style="white-space:pre">FULLNAT(SNAT+DNAT)</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>FULLNAT模式是在NAT模式的基础上做一次源地址转换（即SNAT），做SNAT的好处是可以让应答流量经过正常的三层路由回到负载均衡上，这样负载均衡就不要以网关形式存在于网络中，对网络环境要求较低。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>优点：&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>1. 应用服务器无需做配置&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>2. 对网络环境要求比较低&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; font-weight:600; color:#ff0000;&quot;>缺点：&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>1. 丢失client ip&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(143,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="204" transform="matrix(1,0,0,1,1220,669)" ed:width="87.8" ed:height="23.35" id="214">
        <path stroke-linejoin="round" stroke="#f1a3dc" d="M0,23.4L87.8,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">美团MGW</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>下面详细介绍一下FULLNAT模式。首先负载均衡上需要存在一个&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffff00;&quot;>localip池&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>，在做SNAT时的源IP就是从localip池中选择的。当客户端流量到达负载均衡设备以后，负载均衡会根据调度策略在应用服务器池中选择一个应用服务器，然后将数据包的目的IP改为应用服务器的IP。同时从localip池中选择一个localip将数据包的源IP改为localip，这样应用服务器在应答时，目的IP是localip，而localip是真实存在于负载均衡上的IP地址，因此可以经过正常的三层路由到达负载均衡。由于FULLNAT比NAT模式多做了一次SNAT，并且SNAT中有选端口的操作，因此其性能要逊色于NAT模式，但是&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffff00;&quot;>由于其较强的网络环境适应性&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>，我们选择了FULLNAT作为MGW的转发模式。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(62,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="214" transform="matrix(1,0,0,1,1334,595)" ed:width="229.4" ed:height="23.35" id="216">
        <path stroke-linejoin="round" stroke="#f1a3dc" d="M0,23.4L229.4,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">中断问题及协议栈路径性能过长</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>中断是影响LVS性能最重要的一个因素，假如我们一秒需要处理600万的数据包，每6个数据包产生一个硬件中断的话，那一秒就会产生100万个硬件中断，每一次产生硬件中断都会打断正在进行密集计算的负载均衡程序，中间产生大量的cache miss，对性能的影响异常大。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>同时由于LVS是基于内核netfilter开发的一个应用程序，而netfilter是运行在内核协议栈的一个钩子框架。这就意味着当数据包到达LVS时，已经经过了一段很长的协议栈处理，但是这段处理对于LVS来说都不是必需的，这也造成了一部分不必要的性能损耗。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>针对这两个问题，解决方法是使用&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffff00;&quot;>轮询模式的驱动&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>以及做&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffff00;&quot;>kernel bypass&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>，而DPDK提供的用户态PMD驱动恰好可以解决这两个问题。DPDK在设计时使用了大量硬件相关特性比如numa、 memory channel、 DDIO等，对性能优化非常大，同时提供了比较多网络方面的库，可以大大减小开发难度，提高开发效率。因此选择DPDK作为MGW的开发框架。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(204,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="214" transform="matrix(1,0,0,1,1334,625)" ed:width="103" ed:height="23.35" id="218">
        <path stroke-linejoin="round" stroke="#f1a3dc" d="M0,23.4L103,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">session锁</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>首先介绍一下RSS（Receive Side Scaling），RSS是一个通过数据包的元组信息将数据包散列到不同网卡队列的功能，这时候不同的CPU再去对应的网卡队列读取数据进行处理，就可以充分利用CPU资源。之前介绍MGW使用FULLNAT的模式，FULLNAT会将数据包的元组信息全部改变，&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffff00;&quot;>这样同一个连接，请求和应答方向的数据包有可能会被RSS散列到不同的网卡队列中，在不同的网卡队列也就意味着在被不同的CPU进行处理，&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; color:#ff0000; background-color:#ffff00;&quot;>这时候在访问session结构的时候就需要对这个结构进行加锁保护&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffff00;&quot;>。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>解决这个问题的方法有两种，一种就是在做SNAT选端口的时候，通过选择一个端口lport0让RSS(cip0, cport0, vip0, vport0) = RSS(dip0, dport0, lip0, lport0)相等；&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffff00;&quot;>另外一种方法就是我们为每个CPU分配一个localip，在做SNAT选IP的时候，不同的CPU选择自己的localip，等应答回来以后，再通过lip和CPU的映射关系，将指定目的IP的数据包送到指定队列上&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>由于第二种方法恰好可以被网卡的flow director特性支持，因此我们选择了第二种方法来去掉session结构的锁。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;img src=&quot;data:image/png;base64,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&quot; width=&quot;298.75&quot; height=&quot;186.25&quot; />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>flow director可以根据一定策略将指定的数据包送到指定网卡队列，其在网卡中的优先级要比RSS高，因此我们在做初始化的时候就为每个CPU分配一个localip，比如为cpu0分配lip0，为cpu1分配lip1，为cpu2分配lip2，为cpu3分配lip3。 当一个请求包（cip0, cport0, vip0, vport0）到达负载均衡后，被RSS散列到了队列0上，这时这个包被cpu0处理。cpu0在对其做fullnat时，选择cpu0自己的localip lip0，然后将数据包（lip0, lport0, dip0, dport0）发到应用服务器，在应用服务器应答后，应答数据包（dip0, dport0, lip0, lport0）被发到了负载均衡服务器。此时我们就可以在flow director下一条将目的IP为lip0的数据包送到队列0的规则，这样应答数据包就会被送到队列0让cpu0处理。这时候CPU在对同一个连接两个方向的数据包进行处理的时候就是完全串行的一个操作，也就不要再对session结构进行加锁保护了&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(77,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="214" transform="matrix(1,0,0,1,1334,654)" ed:width="107" ed:height="23.35" id="220">
        <path stroke-linejoin="round" stroke="#f1a3dc" d="M0,23.4L107,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">上下文切换</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>在设计时，希望控制平面与数据平面完全分离，数据平面专心做自己的处理，不被任事件打断。因此将CPU分成两组，一组用作数据平面一组用做控制平面。同时，对数据平面的CPU进行CPU隔离，这样控制平面的进程就不会调度到数据平面的这组CPU上面了；对数据平面的线程进行CPU绑定，这样就可以让每个数据线程独占一个CPU。 其他的控制平面的程序比如Linux kernel、 SSH等都跑在控制平面的这组CPU上。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>下面从MGW集群、MGW单机以及应用服务器层这三个层介绍MGW如何在每一层实现高可靠。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(81,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="214" transform="matrix(1,0,0,1,1334,684)" ed:width="93.40000000000001" ed:height="23.35" id="222">
        <path stroke-linejoin="round" stroke="#f1a3dc" d="M0,23.4L93.4,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">故障切换</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>在故障切换的问题上，我们希望在机器故障以后，交换机可以立刻将流量切到其他机器上，因为流量不切走，意味着到达这台机器流量会被全部丢掉，产生大量丢包。经过调研测试发现，当交换机侧全部使用物理接口并且服务器侧对接口进行断电时，交换机会瞬间将流量切换到其他机器上。通过一个100ms发两个包的测试（客户端和服务端各发一个），这种操作方法是0丢包的。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>由于故障切换主要依赖于交换机的感知，当服务器上出现一些异常，交换机感知不到时，交换机就无法进行故障切换操作，因此需要一个健康自检程序，每半秒进行一次健康自检，当发现服务器存在异常时就对服务器执行网口断电操作，从而让流量立刻切走。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>故障切换主要依赖于网口断电操作并且网卡驱动是跑在主程序里面的，当主程序挂掉以后，就无法再对网口执行断电操作了，因此为了解决这个问题，主进程会捕获异常信号，当发现异常时就对网卡进行断电操作，在断电操作结束以后再继续将信号发给系统进行处理。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>经过以上设计，MGW可以做到升级操作0丢包，主程序故障0丢包，其他异常（网线等）会有一个最长500ms的丢包，因为这种异常需要靠自检程序去检测，而自检程序的周期是500ms。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(68,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="214" transform="matrix(1,0,0,1,1334,714)" ed:width="134.2" ed:height="23.35" id="224">
        <path stroke-linejoin="round" stroke="#f1a3dc" d="M0,23.4L134.2,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">故障恢复与扩容</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>无论是在进行故障恢复还是扩容操作，都会导致集群节点数量发生变化，这样也就会导致流量路径发生变化。当变化的流量到达集群中原有的节点时，因为原有节点都维护着一个全局的session表，因此这些流量是可以被正常转发的；但是如果流量到达了新机器上，这个机器是没有全局session表的，那么这部分流量就会全部被丢弃。为了解决这个问题，MGW在上线以后会经历一个预上线的中间状态，在这个状态上，MGW不会让交换机感知到自己上线了，这样交换机也就不会把流量切过来。首先MGW会对集群中其他节点发送一个批量同步的请求，其他节点收到请求以后会将自己的session全量的同步到新上线的节点上，新上线节点在收到全部session以后才会让交换机感知到自己上线，这时交换机再将流量切过来就可以正常被转发出去了。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>在这个过程中主要存在两点问题。 第一个问题是，由于集群中并没有一个主控节点来维护一个全局的状态，如果request报丢失或者session同步的数据丢失的话，那新上线节点就没办法维护一个全局的session状态。但是考虑到所有节点都维护着一个全局的session表，因此所有节点拥有的session数量都是相同的，那么就可以在所有节点每次做完批量同步以后发送一个finish消息，finish消息中带着自己拥有的session数量。当新上线节点收到finish消息以后，便会以自己的session数量与finish中的数量做对比。当达到数量要求以后，新上线节点就控制自己进行上线操作。否则在等待一定的超时时间以后，重新进行一次批量同步操作，直到达到要求为止。&lt;/span>&lt;/p>&lt;p style=&quot;-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;  font-family:'Consolas'; font-size:11pt;&quot;>&lt;br />&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>另外一个问题是在进行批量同步操作时，如果出现了新建连接，那么新建连接就不会通过批量同步同步到新上线的机器上。如果新建连接特别多，就会导致新上线机器一直达不到要求。因此，需要保证处于预上线状态的机器能接收到增量同步数据，因为新建连接可以通过增量同步同步出来。通过增量同步和批量同步就可以保证新上线机器可以最终获得一个全局的session表。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(108,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="214" transform="matrix(1,0,0,1,1334,744)" ed:width="184.6" ed:height="23.35" id="226">
        <path stroke-linejoin="round" stroke="#f1a3dc" d="M0,23.4L184.6,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">一致性源IP hash调度器</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>源IP Hash调度器主要是保证相同的客户端的连接被调度到相同应用服务器上，也就是说建立一个客户端与应用服务器一对一的映射关系。普通的源IP Hash调度器在应用服务器发生变化以后会导致映射关系发生改变，会对业务造成影响。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>因此我们开发了一致性源IP Hash调度器，保证在应用服务器集群发生变化时，只有发生变化的应用服务器与客户端的映射关系发生改变，其他都是不变的。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>为了保证流量的均衡，首先在hash环上分配固定数量的虚拟节点，然后将&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt; background-color:#ffff00;&quot;>虚拟机节点均衡的重分布到物理节点上&lt;/span>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>，重分布算法需要保证两点：&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>1. 在物理节点发生变化时，只有少数虚拟节点映射关系发生变化，也就是要保证一致性Hash的基本原则。&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>2. 因为MGW是以集群的形式存在的，当多个应用服务器发生上线下线操作时，反馈到不同的MGW节点上就有可能会出现顺序不一致的问题，因此无论不同的MGW节点产生何种应用服务器上下线顺序，都需要保证最终的映射关系一致，因为如果不一致就导致相同客户端的连接会被不同的MGW节点调度到不同的应用服务器上，也就违背了源IP Hash调度器的原则。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(159,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="101" transform="matrix(1,0,0,1,952,853)" ed:width="116" ed:height="33.55" id="228">
        <path stroke-linejoin="round" stroke="#6cc9e5" d="M0,33.5L116,33.5" stroke-width="2" fill="none"/>
        <text class="st47">
            <tspan y="22.3" x="17" style="white-space:pre">消息中间件</tspan>
        </text>
    </g>
    <g ed:layout="rightmap" ed:parentid="228" transform="matrix(1,0,0,1,1095,800)" ed:width="93.40000000000001" ed:height="23.35" id="232">
        <path stroke-linejoin="round" stroke="#6cc9e5" d="M0,23.4L93.4,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">基本流程</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>1. 消息生成者发送消息MQ收到消息&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>2. 将消息进行持久化，在存储中新增一条记录&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>3. 返回ACK给生产者&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>4. MQ push 消息给对应的消费者，然后等待消费者返回ACK&lt;/span>&lt;/p>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>5. 如果消息消费者在指定时间内成功返回ACK，那么MQ认为消息消费成功，在存储中删除消息，；如果MQ在指定时间内没有收到ACK，则认为消息消费失败，会尝试重新push消息,重复执行4、5MQ删除消息&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(68,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="228" transform="matrix(1,0,0,1,1095,873)" ed:width="72.40000000000001" ed:height="23.35" id="234">
        <path stroke-linejoin="round" stroke="#6cc9e5" d="M0,23.4L72.4,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">底层存储</tspan>
        </text>
    </g>
    <g ed:layout="rightmap" ed:parentid="234" transform="matrix(1,0,0,1,1195,830)" ed:width="111" ed:height="21.75" id="236">
        <path stroke-linejoin="round" stroke="#6cc9e5" d="M0,21.8L111,21.8" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="14.7" x="8" style="white-space:pre">Commit Log</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:10pt;&quot;>一个文件集合，每个文件1G大小，存储满后存下一个，为了讨论方便可以把它当做一个文件，所有消息内容全部持久化到这个文件中。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(85,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="234" transform="matrix(1,0,0,1,1195,858)" ed:width="132.6" ed:height="21.75" id="238">
        <path stroke-linejoin="round" stroke="#6cc9e5" d="M0,21.8L132.6,21.8" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="14.7" x="8" style="white-space:pre">Consume Queue</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>一个Topic可以有很多个Consume Queue，每个文件代表一个逻辑队列，这里存放消息在Commit Log的偏移量以及大小和tag属性。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(107,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="234" transform="matrix(1,0,0,1,1195,902)" ed:width="45.2" ed:height="23.35" id="240">
        <path stroke-linejoin="round" stroke="#6cc9e5" d="M0,23.4L45.2,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">落盘</tspan>
        </text>
    </g>
    <g ed:layout="rightmap" ed:parentid="240" transform="matrix(1,0,0,1,1267,887)" ed:width="93.40000000000001" ed:height="23.35" id="242">
        <path stroke-linejoin="round" stroke="#6cc9e5" d="M0,23.4L93.4,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">同步落盘</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>在消息真正落盘后，才返回成功给Producer，只要磁盘阵列RAID5完好，消息就不会丢。一般只用于金融场景，这种方式不是本文讨论的重点，因为没有充分利用Page Cache的特点。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(68,3)" xlink:href="#note"/>
        </g>
    </g>
    <g ed:layout="rightmap" ed:parentid="240" transform="matrix(1,0,0,1,1267,916)" ed:width="93.40000000000001" ed:height="23.35" id="244">
        <path stroke-linejoin="round" stroke="#6cc9e5" d="M0,23.4L93.4,23.4" stroke-width="2" fill="none"/>
        <text class="st48">
            <tspan y="16.3" x="8" style="white-space:pre">异步落盘</tspan>
        </text>
        <g ed:note="&lt;body style=&quot; font-family:'SimSun'; font-size:9pt; font-weight:400; font-style:normal;&quot;>&lt;p style=&quot; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px; &quot;>&lt;span style=&quot; font-family:'Consolas'; font-size:11pt;&quot;>读写文件充分利用了Page Cache，即写入Page Cache就返回成功给Producer。之后的内容全部以异步刷盘方式来讨论。&lt;/span>&lt;/p>&lt;/body>">
            <use transform="translate(68,3)" xlink:href="#note"/>
        </g>
    </g>
    <symbol id="plus">
        <path d="M11,6C11,8.8,8.8,11,6,11C3.2,11,1,8.8,1,6C1,3.2,3.2,1,6,1C8.8,1,11,3.2,11,6z" fill="url(#lg14)"/>
        <path stroke="#46a000" d="M11,6C11,8.8,8.8,11,6,11C3.2,11,1,8.8,1,6C1,3.2,3.2,1,6,1C8.8,1,11,3.2,11,6zM3,6L9,6M6,3L6,9" stroke-width="0.7" fill="none"/>
    </symbol>
    <symbol id="minus">
        <path d="M11,6C11,8.8,8.8,11,6,11C3.2,11,1,8.8,1,6C1,3.2,3.2,1,6,1C8.8,1,11,3.2,11,6z" fill="url(#lg14)"/>
        <path stroke="#46a000" d="M11,6C11,8.8,8.8,11,6,11C3.2,11,1,8.8,1,6C1,3.2,3.2,1,6,1C8.8,1,11,3.2,11,6zM3,6L9,6" stroke-width="0.7" fill="none"/>
    </symbol>
    <g ed:togtopicid="101" transform="translate(890,475)">
        <use xlink:href="#minus"/>
    </g>
    <g ed:togtopicid="105" transform="translate(1053,199)">
        <use xlink:href="#minus"/>
    </g>
    <g ed:togtopicid="111" transform="translate(1153,199)">
        <use xlink:href="#minus"/>
    </g>
    <g ed:togtopicid="117" transform="translate(1266,169)">
        <use xlink:href="#minus"/>
    </g>
    <g ed:togtopicid="125" transform="translate(1273,273)">
        <use xlink:href="#minus"/>
    </g>
    <g ed:togtopicid="138" transform="translate(571,609)">
        <use xlink:href="#minus"/>
    </g>
    <g ed:togtopicid="146" transform="translate(501,470)">
        <use xlink:href="#minus"/>
    </g>
    <g ed:togtopicid="152" transform="translate(587,484)">
        <use xlink:href="#minus"/>
    </g>
    <g ed:togtopicid="154" transform="translate(515,514)">
        <use xlink:href="#minus"/>
    </g>
    <g ed:togtopicid="158" transform="translate(587,383)">
        <use xlink:href="#minus"/>
    </g>
    <g ed:togtopicid="180" transform="translate(1037,365)">
        <use xlink:href="#minus"/>
    </g>
    <g ed:togtopicid="184" transform="translate(1053,588)">
        <use xlink:href="#minus"/>
    </g>
    <g ed:togtopicid="186" transform="translate(1153,441)">
        <use xlink:href="#minus"/>
    </g>
    <g ed:togtopicid="192" transform="translate(603,307)">
        <use xlink:href="#minus"/>
    </g>
    <g ed:togtopicid="204" transform="translate(1194,618)">
        <use xlink:href="#minus"/>
    </g>
    <g ed:togtopicid="214" transform="translate(1308,675)">
        <use xlink:href="#minus"/>
    </g>
    <g ed:togtopicid="228" transform="translate(1069,864)">
        <use xlink:href="#minus"/>
    </g>
    <g ed:togtopicid="234" transform="translate(1169,879)">
        <use xlink:href="#minus"/>
    </g>
    <g ed:togtopicid="240" transform="translate(1241,907)">
        <use xlink:href="#minus"/>
    </g>
</svg>
</div>
        <div id="copyright">Created With  <a href="https://www.edrawsoft.com/" target="_blank" title="edrawsoft">MindMaster</a></div>
      </div>
    </div>
    <script>eval(atob('dmFyIG11YT13aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudDsNCnZhciB1YT0obXVhLmluZGV4T2YoJ3J2OjExJykrbXVhLmluZGV4T2YoJ01TSUUnKSk+PTA7DQpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc3ZnLWNvbnRhaW5lcicpLm9uY29udGV4dG1lbnUgPSBmdW5jdGlvbiAoZXZlbnQpIHsNCiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOw0KfQ0KZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N2Zy1jb250YWluZXInKS5vbm1vdXNlZG93biA9IGZ1bmN0aW9uIChldmVudCkgew0KICAgIGlmKGV2ZW50LndoaWNoID09Myl7DQogICAgICAgIHRoaXMuc3R5bGUuY3Vyc29yID0gJ3BvaW50ZXInOw0KICAgICAgICB0aGlzLm9ubW91c2Vtb3ZlID0gZnVuY3Rpb24gKGV2KSB7DQogICAgICAgICAgICB0aGlzLnNjcm9sbEJ5KC0oZXYubW92ZW1lbnRYKSwgMCk7DQogICAgICAgICAgICB3aW5kb3cuc2Nyb2xsQnkoMCwtKGV2Lm1vdmVtZW50WSkpDQogICAgICAgIH0NCiAgICAgICAgdGhpcy5vbm1vdXNldXAgPSBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB0aGlzLnN0eWxlLmN1cnNvciA9ICBudWxsOw0KICAgICAgICAgICAgdGhpcy5vbm1vdXNldXAgPSBudWxsOw0KICAgICAgICAgICAgdGhpcy5vbm1vdXNlbW92ZSA9IG51bGw7DQogICAgICAgIH0NCiAgICB9DQp9DQpOdW1iZXIucHJvdG90eXBlLnRvc3VpdHN2Zz1mdW5jdGlvbiAoKSB7DQogICAgdmFyIG51bT10aGlzLnZhbHVlT2YoKTsNCiAgICBpZihudW0lMT09PTApew0KICAgICAgICByZXR1cm4gbnVtKzAuNQ0KICAgIH1lbHNlIHJldHVybiBudW07DQp9Ow0KTnVtYmVyLnByb3RvdHlwZS5wbHVzej1mdW5jdGlvbigpIHsNCiAgICB2YXIgbnVtPXRoaXMudmFsdWVPZigpOw0KICAgIHJldHVybiBudW08MTA/JzAnK251bTpudW07DQp9Ow0KZnVuY3Rpb24gcGFyc2VEYXRlKG51bSkgew0KICAgIHZhciBkYXRlID0gbmV3IERhdGUobnVtKTsNCiAgICB2YXIgWSA9IGRhdGUuZ2V0RnVsbFllYXIoKSArICctJzsNCiAgICB2YXIgTSA9IChkYXRlLmdldE1vbnRoKCkrMSkucGx1c3ooKSArICctJzsNCiAgICB2YXIgRCA9IGRhdGUuZ2V0RGF0ZSgpLnBsdXN6KCkgKyAnICc7DQogICAgdmFyIGggPSBkYXRlLmdldEhvdXJzKCkucGx1c3ooKSArICc6JzsNCiAgICB2YXIgbW0gPSBkYXRlLmdldE1pbnV0ZXMoKS5wbHVzeigpICsgJzonOw0KICAgIHZhciBzID0gZGF0ZS5nZXRTZWNvbmRzKCkucGx1c3ooKTsNCiAgICByZXR1cm4gWStNK0QraCttbStzOw0KfQ0KLy8tLXByZWRlZmluZWQNCi8vY29tbWVudC0tDQp2YXIgY29tbWVudHM9ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnZz5nW2VkXFw6Y29tbWVudF0nKTsNCmZ1bmN0aW9uIGdldGN3aChwb3B1cCkgew0KICAgIGRvY3VtZW50LmJvZHkuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3N2ZycpWzBdLmFwcGVuZENoaWxkKHBvcHVwKTsNCiAgICB2YXIgdz1wb3B1cC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aDsNCiAgICB2YXIgaD1wb3B1cC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQ7DQogICAgcmV0dXJuIFt3LGhdDQp9DQpmb3IodmFyIGk9MDtpPGNvbW1lbnRzLmxlbmd0aDtpKyspew0KICAgIHZhciBwb3B1cD1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywnZycpOw0KICAgIHZhciBwb3B1cFI9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCdyZWN0Jyk7DQogICAgdmFyIGhvdmVyPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCdyZWN0Jyk7DQogICAgdmFyIG9saW5lPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCdyZWN0Jyk7DQogICAgaG92ZXIuc2V0QXR0cmlidXRlKCdmaWxsJywnI2NkY2RmZicpOw0KICAgIGhvdmVyLnNldEF0dHJpYnV0ZSgneCcsJzAnKTsNCiAgICBob3Zlci5zZXRBdHRyaWJ1dGUoJ3knLCcwJyk7DQogICAgaG92ZXIuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCcxNicpOw0KICAgIGhvdmVyLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCcxNicpOw0KICAgIGhvdmVyLnNldEF0dHJpYnV0ZSgnZmlsbC1vcGFjaXR5JywnMC42Jyk7DQogICAgaG92ZXIuc2V0QXR0cmlidXRlKCd0cmFuc2Zvcm0nLGNvbW1lbnRzW2ldLnF1ZXJ5U2VsZWN0b3IoJ3VzZScpLmdldEF0dHJpYnV0ZSgndHJhbnNmb3JtJykpOw0KICAgIGhvdmVyLnN0eWxlLmRpc3BsYXk9J25vbmUnOw0KICAgIGNvbW1lbnRzW2ldLmFwcGVuZENoaWxkKGhvdmVyKTsNCiAgICB2YXIgYT1KU09OLnBhcnNlKGNvbW1lbnRzW2ldLmdldEF0dHJpYnV0ZSgnZWQ6Y29tbWVudCcpKTsNCiAgICB2YXIgaGVpZ2h0PTA7DQogICAgdmFyIGNhcnI9W107DQogICAgZm9yKHZhciBqPTA7ajxhLmxlbmd0aDtqKyspew0KICAgICAgICB2YXIgc3RhbXA9TnVtYmVyKGFbal0uRGF0ZSkqMTAwMDsNCiAgICAgICAgdmFyIHRpbWU9cGFyc2VEYXRlKHN0YW1wKTsNCiAgICAgICAgdmFyIG5hbWU9YVtqXS5OYW1lOw0KICAgICAgICB2YXIgbWVzc2FnZT1hW2pdLk1lc3NhZ2U7DQogICAgICAgIHZhciBtZXNzYWdlQXJyPW1lc3NhZ2Uuc3BsaXQoL1xuLyk7DQogICAgICAgIHZhciBvPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCdnJyk7DQogICAgICAgIHZhciBuPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCd0ZXh0Jyk7DQogICAgICAgIHZhciB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCd0ZXh0Jyk7DQogICAgICAgIHZhciBtPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCd0ZXh0Jyk7DQogICAgICAgIG4uc2V0QXR0cmlidXRlKCd4Jyw1KTsNCiAgICAgICAgbi5zZXRBdHRyaWJ1dGUoJ3knLDEyKTsNCiAgICAgICAgbi5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCcjMDA2ZWZmJyk7DQogICAgICAgIG4udGV4dENvbnRlbnQ9bmFtZSsnOiAnOw0KICAgICAgICBuLnNldEF0dHJpYnV0ZSgnZm9udC1zaXplJywnMTInKTsNCiAgICAgICAgdC5zZXRBdHRyaWJ1dGUoJ3gnLDIwMCk7DQogICAgICAgIHQuc2V0QXR0cmlidXRlKCd5JywxMik7DQogICAgICAgIHQuc2V0QXR0cmlidXRlKCdmaWxsJywnIzk2OTY5NicpOw0KICAgICAgICB0LnRleHRDb250ZW50PXRpbWU7DQogICAgICAgIHQuc2V0QXR0cmlidXRlKCdmb250LXNpemUnLCcxMCcpOw0KICAgICAgICBtLnNldEF0dHJpYnV0ZSgndHJhbnNmb3JtJywndHJhbnNsYXRlKDIwLDI3KScpOw0KICAgICAgICBtLnNldEF0dHJpYnV0ZSgnZm9udC1zaXplJywnMTInKTsNCiAgICAgICAgZm9yKHZhciBrPTA7azxtZXNzYWdlQXJyLmxlbmd0aDtrKyspew0KICAgICAgICAgICAgdmFyIHRzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCd0c3BhbicpOw0KICAgICAgICAgICAgdHMuc2V0QXR0cmlidXRlKCd4JywnMCcpOw0KICAgICAgICAgICAgdHMuc2V0QXR0cmlidXRlKCd5JyxrKjE2KTsNCiAgICAgICAgICAgIHRzLnRleHRDb250ZW50PW1lc3NhZ2VBcnJba107DQogICAgICAgICAgICBtLmFwcGVuZENoaWxkKHRzKTsNCiAgICAgICAgfQ0KICAgICAgICBvLnNldEF0dHJpYnV0ZSgndHJhbnNmb3JtJywndHJhbnNsYXRlKDAsJytoZWlnaHQrJyknKTsNCiAgICAgICAgby5hcHBlbmRDaGlsZChuKTsNCiAgICAgICAgby5hcHBlbmRDaGlsZCh0KTsNCiAgICAgICAgby5hcHBlbmRDaGlsZChtKTsNCiAgICAgICAgY2Fyci5wdXNoKG8pOw0KICAgICAgICBwb3B1cC5hcHBlbmRDaGlsZChvKTsNCiAgICAgICAgaGVpZ2h0PShtZXNzYWdlQXJyLmxlbmd0aCsxKSoxNitoZWlnaHQ7DQogICAgfQ0KICAgIHZhciB3YXJyPWdldGN3aChwb3B1cCk7DQogICAgb2xpbmUuc2V0QXR0cmlidXRlKCd4JywnMCcpOw0KICAgIG9saW5lLnNldEF0dHJpYnV0ZSgneScsJzAnKTsNCiAgICB2YXIgb3c9d2FyclswXSsxMC41Ow0KICAgIHZhciBvaD13YXJyWzFdKzM7DQogICAgb2xpbmUuc2V0QXR0cmlidXRlKCd3aWR0aCcsb3cpOw0KICAgIG9saW5lLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JyxvaCk7DQogICAgb2xpbmUuc2V0QXR0cmlidXRlKCdmaWxsJywnd2hpdGUnKTsNCiAgICBvbGluZS5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsJyM2NTY1NjUnKTsNCiAgICBwb3B1cC5hcHBlbmRDaGlsZChvbGluZSk7DQogICAgdmFyIGw9Y2Fyci5sZW5ndGg7DQogICAgd2hpbGUobC0tKXsNCiAgICAgICAgcG9wdXAuYXBwZW5kQ2hpbGQoY2FycltsXSk7DQogICAgfQ0KICAgIHBvcHVwLm9ubW91c2VvdmVyPWZ1bmN0aW9uICgpIHsNCiAgICAgICAgdGhpcy5zdHlsZS5kaXNwbGF5PSdibG9jayc7DQogICAgfTsNCiAgICBwb3B1cC5vbm1vdXNlb3V0PWZ1bmN0aW9uICgpIHsNCiAgICAgICAgdGhpcy5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgIH07DQogICAgdmFyIGNzPWNvbW1lbnRzW2ldLnF1ZXJ5U2VsZWN0b3IoJ3VzZScpLmdldEF0dHJpYnV0ZSgndHJhbnNmb3JtJykubWF0Y2goL1woKFxTKnxcUypcc1xTKilcKS8pWzFdLnNwbGl0KC8gfCwvKTsNCiAgICB2YXIgcHM9Y29tbWVudHNbaV0ucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoJ3RyYW5zZm9ybScpOw0KICAgIGlmKHBzLnN1YnN0cigwLDIpID09ICd0cicpew0KICAgICAgICB2YXIgcHBzID0gcHMubWF0Y2goL1woKFxTKnxcUypcc1xTKilcKS8pWzFdLnNwbGl0KC8gfCwvKTsNCiAgICAgICAgdmFyIHg9cGFyc2VGbG9hdChjc1swXSkrcGFyc2VGbG9hdChwcHNbMF0pOw0KICAgICAgICB2YXIgeT1wYXJzZUZsb2F0KHBwc1sxXSk7DQogICAgICAgIHg9eC50b3N1aXRzdmcoKTsNCiAgICAgICAgeT15LnRvc3VpdHN2ZygpOw0KICAgICAgICB2YXIgdHJzdHIgPSAndHJhbnNsYXRlKCcreCsnLCcreSsnKSc7DQogICAgfQ0KICAgIGVsc2UgaWYocHMuc3Vic3RyKDAsMikgPT0gJ21hJyl7DQogICAgICAgIHZhciBwcHMgPSBwcy5tYXRjaCgvKFwtP1xkKyhcLlxkKyk/KVtcLCBdKFwtP1xkKyhcLlxkKyk/KVtcLCBdKFwtP1xkKyhcLlxkKyk/KVtcLCBdKFwtP1xkKyhcLlxkKyk/KVtcLCBdKFwtP1xkKyhcLlxkKyk/KVtcLCBdKFwtP1xkKyhcLlxkKyk/KVwpJC8pOw0KICAgICAgICB2YXIgbWFBcnIgPSBbcGFyc2VGbG9hdChwcHNbMV0pLHBhcnNlRmxvYXQocHBzWzNdKSxwYXJzZUZsb2F0KHBwc1s1XSkscGFyc2VGbG9hdChwcHNbN10pLHBhcnNlRmxvYXQocHBzWzldKSxwYXJzZUZsb2F0KHBwc1sxMV0pXTsNCiAgICAgICAgaWYobWFBcnJbMV0gPT0gMCl7DQogICAgICAgICAgICB2YXIgeCA9IHBhcnNlRmxvYXQoY3NbMF0pOw0KICAgICAgICAgICAgdmFyIHk9IHBhcnNlRmxvYXQoY3NbMV0pKzE2Ow0KICAgICAgICAgICAgdmFyIHgxID0geCAqIG1hQXJyWzBdICsgeSAqIG1hQXJyWzJdICsgbWFBcnJbNF07DQogICAgICAgICAgICB2YXIgeTEgPSB4ICogbWFBcnJbMV0gKyB5ICogbWFBcnJbM10gKyBtYUFycls1XTsNCiAgICAgICAgICAgIHgxPXgxLnRvc3VpdHN2ZygpOw0KICAgICAgICAgICAgeTE9eTEudG9zdWl0c3ZnKCk7DQogICAgICAgICAgICB2YXIgdHJzdHIgPSAgJ3RyYW5zbGF0ZSgnK3gxKycsJyt5MSsnKSc7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgdmFyIHggPSBwYXJzZUZsb2F0KGNzWzBdKSsxNjsNCiAgICAgICAgICAgIHZhciB5ID0gcGFyc2VGbG9hdChjc1sxXSkrMTY7DQogICAgICAgICAgICB2YXIgeDEgPSB4ICogbWFBcnJbMF0gKyB5ICogbWFBcnJbMl0gKyBtYUFycls0XTsNCiAgICAgICAgICAgIHZhciB5MSA9IHggKiBtYUFyclsxXSArIHkgKiBtYUFyclszXSArIG1hQXJyWzVdOw0KICAgICAgICAgICAgeCA9IHBhcnNlRmxvYXQoY3NbMF0pKzE2Ow0KICAgICAgICAgICAgeSA9IHBhcnNlRmxvYXQoY3NbMV0pOw0KICAgICAgICAgICAgdmFyIHgyID0geCAqIG1hQXJyWzBdICsgeSAqIG1hQXJyWzJdICsgbWFBcnJbNF07DQogICAgICAgICAgICB2YXIgeTIgPSB4ICogbWFBcnJbMV0gKyB5ICogbWFBcnJbM10gKyBtYUFycls1XTsNCiAgICAgICAgICAgIHZhciBmeCA9IHgxPHgyP3gxLnRvc3VpdHN2ZygpOiB4Mi50b3N1aXRzdmcoKTsNCiAgICAgICAgICAgIHZhciBmeSA9IHkxPnkyP3kxLnRvc3VpdHN2ZygpOiB5Mi50b3N1aXRzdmcoKTsNCiAgICAgICAgICAgIHZhciBvZmZ5ID0gTWF0aC5hYnMoeTEteTIpOw0KICAgICAgICAgICAgdmFyIHRyc3RyID0gICd0cmFuc2xhdGUoJytmeCsnLCcrZnkrJyknOw0KICAgICAgICAgICAgcG9wdXBSLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JyxvZmZ5LnRvU3RyaW5nKCkpOw0KICAgICAgICAgICAgcG9wdXBSLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCcxNicpOw0KICAgICAgICAgICAgcG9wdXBSLnNldEF0dHJpYnV0ZSgneScsKC1vZmZ5KS50b1N0cmluZygpKTsNCiAgICAgICAgICAgIHBvcHVwUi5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCd0cmFuc3BhcmVudCcpOw0KICAgICAgICAgICAgcG9wdXAuYXBwZW5kQ2hpbGQocG9wdXBSKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBwb3B1cC5zZXRBdHRyaWJ1dGUoJ3RyYW5zZm9ybScsdHJzdHIpOw0KICAgIHBvcHVwLnNldEF0dHJpYnV0ZSgnY29tbWVudCcsJycpOw0KICAgIHBvcHVwLnN0eWxlLmRpc3BsYXk9J25vbmUnOw0KICAgIHBvcHVwLnNldEF0dHJpYnV0ZSgnZWQ6Y29tbWVudGlkJyxjb21tZW50c1tpXS5wYXJlbnROb2RlLmlkKTsNCiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc3ZnLWNvbnRhaW5lciA+IHN2ZycpLmFwcGVuZENoaWxkKHBvcHVwKTsNCiAgICBjb21tZW50c1tpXS5vbm1vdXNlb3Zlcj1mdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciBjb21tZW50aWQ9dGhpcy5wYXJlbnROb2RlLmlkOw0KICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJ3JlY3QnKS5zdHlsZS5kaXNwbGF5PSdibG9jayc7DQogICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoImdbZWRcXDpjb21tZW50aWQ9JyIrY29tbWVudGlkKyInXVtjb21tZW50XSIpLnN0eWxlLmRpc3BsYXk9J2Jsb2NrJzsNCiAgICB9Ow0KICAgIGNvbW1lbnRzW2ldLm9ubW91c2VvdXQ9ZnVuY3Rpb24gKCkgew0KICAgICAgICB2YXIgY29tbWVudGlkPXRoaXMucGFyZW50Tm9kZS5pZDsNCi8vICAgICAgICB3aW5kb3cuZ2V0U2VsZWN0aW9uKCkucmVtb3ZlQWxsUmFuZ2VzKCk7DQogICAgICAgIHRoaXMucXVlcnlTZWxlY3RvcigncmVjdCcpLnN0eWxlLmRpc3BsYXk9J25vbmUnOw0KICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJnW2VkXFw6Y29tbWVudGlkPSciK2NvbW1lbnRpZCsiJ11bY29tbWVudF0iKS5zdHlsZS5kaXNwbGF5PSdub25lJzsNCiAgICB9DQp9DQovLy0tY29tbWVudA0KLy9ub3RlLS0NCmlmKCF1YSl7DQogICAgdmFyIG5vdGVzPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2c+Z1tlZFxcOm5vdGVdJyk7DQogICAgZnVuY3Rpb24gZ2V0d2gocyxwKSB7DQogICAgICAgIHZhciBtYWlucD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICAgICAgbWFpbnAuc3R5bGUuY3NzVGV4dD1zOw0KICAgICAgICBtYWlucC5zdHlsZS5kaXNwbGF5PSdpbmxpbmUtYmxvY2snOw0KCQltYWlucC5zdHlsZS5tYXhXaWR0aCA9ICc0MDBweCc7DQoJCW1haW5wLnN0eWxlLndvcmRCcmVhayA9ICdicmVhay1hbGwnOw0KICAgICAgICBtYWlucC5pbm5lckhUTUw9cDsNCiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtYWlucCk7DQogICAgICAgIHZhciB3PW1haW5wLmNsaWVudFdpZHRoOw0KICAgICAgICB2YXIgaD1tYWlucC5jbGllbnRIZWlnaHQ7DQogICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQobWFpbnApOw0KICAgICAgICByZXR1cm4gW3csaF0NCiAgICB9DQogICAgZm9yKHZhciBpPTA7aTxub3Rlcy5sZW5ndGg7aSsrKXsNCiAgICAgICAgdmFyIGE9bm90ZXNbaV0uZ2V0QXR0cmlidXRlKCdlZDpub3RlJyk7DQoJCXZhciBub3RlTG9jayA9IG5vdGVzW2ldLmdldEF0dHJpYnV0ZSgnZWQ6bm90ZWxvY2snKTsNCiAgICAgICAgaWYobm90ZUxvY2sgPT0gJ3RydWUnKXsNCiAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICB9DQogICAgICAgIHZhciBtYWlucD1hLm1hdGNoKC88Ym9keVtePl0qPiguKik8XC9ib2R5Pi8pWzFdOw0KICAgICAgICB2YXIgbWFpbnM9YS5tYXRjaCgvc3R5bGU9IiguKj8pIi8pWzFdOw0KICAgICAgICB2YXIgb3V0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCdnJyk7DQogICAgICAgIHZhciBvbGluZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywncmVjdCcpOw0KICAgICAgICB2YXIgcG9wdXA9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsJ2ZvcmVpZ25PYmplY3QnKTsNCiAgICAgICAgdmFyIHBvcHVwUj0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsJ3JlY3QnKTsNCiAgICAgICAgdmFyIGhvdmVyPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCdyZWN0Jyk7DQogICAgICAgIGhvdmVyLnNldEF0dHJpYnV0ZSgnZmlsbCcsJyNjZGNkZmYnKTsNCiAgICAgICAgaG92ZXIuc2V0QXR0cmlidXRlKCd4JywnMCcpOw0KICAgICAgICBob3Zlci5zZXRBdHRyaWJ1dGUoJ3knLCcwJyk7DQogICAgICAgIGhvdmVyLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywnMTYnKTsNCiAgICAgICAgaG92ZXIuc2V0QXR0cmlidXRlKCd3aWR0aCcsJzE2Jyk7DQogICAgICAgIGhvdmVyLnNldEF0dHJpYnV0ZSgnZmlsbC1vcGFjaXR5JywnMC42Jyk7DQogICAgICAgIGhvdmVyLnNldEF0dHJpYnV0ZSgndHJhbnNmb3JtJyxub3Rlc1tpXS5xdWVyeVNlbGVjdG9yKCd1c2UnKS5nZXRBdHRyaWJ1dGUoJ3RyYW5zZm9ybScpKTsNCiAgICAgICAgaG92ZXIuc3R5bGUuZGlzcGxheT0nbm9uZSc7DQogICAgICAgIG5vdGVzW2ldLmFwcGVuZENoaWxkKGhvdmVyKTsNCiAgICAgICAgcG9wdXAuc3R5bGUuY3NzVGV4dD1tYWluczsNCiAgICAgICAgcG9wdXAuaW5uZXJIVE1MPW1haW5wOw0KICAgICAgICB2YXIgd2g9Z2V0d2gobWFpbnMsbWFpbnApOw0KICAgICAgICBwb3B1cC5zZXRBdHRyaWJ1dGUoJ3dpZHRoJyx3aFswXSk7DQogICAgICAgIHBvcHVwLnNldEF0dHJpYnV0ZSgnaGVpZ2h0Jyx3aFsxXSk7DQogICAgICAgIHBvcHVwLnNldEF0dHJpYnV0ZSgndHJhbnNmb3JtJywndHJhbnNsYXRlKDgsNCknKTsNCgkJcG9wdXAuc3R5bGUud29yZEJyZWFrID0gJ2JyZWFrLWFsbCc7DQogICAgICAgIHBvcHVwLnN0eWxlLnRleHRBbGlnbj0nbGVmdCc7DQogICAgICAgIG9saW5lLnNldEF0dHJpYnV0ZSgneCcsJzAnKTsNCiAgICAgICAgb2xpbmUuc2V0QXR0cmlidXRlKCd5JywnMCcpOw0KICAgICAgICBvbGluZS5zZXRBdHRyaWJ1dGUoJ3dpZHRoJyx3aFswXSsxNik7DQogICAgICAgIG9saW5lLnNldEF0dHJpYnV0ZSgnaGVpZ2h0Jyx3aFsxXSs4KTsNCiAgICAgICAgb2xpbmUuc2V0QXR0cmlidXRlKCdzdHJva2UnLCcjYTI3YTAwJyk7DQogICAgICAgIG9saW5lLnNldEF0dHJpYnV0ZSgnZmlsbCcsJyNmZmU3OWQnKTsNCiAgICAgICAgb3V0LmFwcGVuZENoaWxkKG9saW5lKTsNCiAgICAgICAgb3V0LmFwcGVuZENoaWxkKHBvcHVwKTsNCiAgICAgICAgb3V0LnNldEF0dHJpYnV0ZSgnbm90ZScsJycpOw0KICAgICAgICBvdXQuc3R5bGUuZGlzcGxheT0nbm9uZSc7DQogICAgICAgIG91dC5zZXRBdHRyaWJ1dGUoJ2VkOm5vdGVpZCcsbm90ZXNbaV0ucGFyZW50Tm9kZS5pZCk7DQogICAgICAgIG91dC5vbm1vdXNlb3Zlcj1mdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB0aGlzLnN0eWxlLmRpc3BsYXk9J2Jsb2NrJzsNCiAgICAgICAgfTsNCiAgICAgICAgb3V0Lm9ubW91c2VvdXQ9ZnVuY3Rpb24gKCkgew0KLy8gICAgICAgIHdpbmRvdy5nZXRTZWxlY3Rpb24gPyB3aW5kb3cuZ2V0U2VsZWN0aW9uKCkucmVtb3ZlUmFuZ2Uod2luZG93LmdldFNlbGVjdGlvbigpLnJlKTpkb2N1bWVudC5zZWxlY3Rpb24uZW1wdHkoKTsNCg0KICAgICAgICAgICAgdGhpcy5zdHlsZS5kaXNwbGF5PSdub25lJzsNCiAgICAgICAgfTsNCiAgICAgICAgdmFyIGNzPW5vdGVzW2ldLnF1ZXJ5U2VsZWN0b3IoJ3VzZScpLmdldEF0dHJpYnV0ZSgndHJhbnNmb3JtJykubWF0Y2goL1woKFxTKnxcUypcc1xTKilcKS8pWzFdLnNwbGl0KC8gfCwvKTsNCiAgICAgICAgdmFyIHBzPW5vdGVzW2ldLnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCd0cmFuc2Zvcm0nKTsNCiAgICAgICAgaWYocHMuc3Vic3RyKDAsMikgPT0gJ3RyJyl7DQogICAgICAgICAgICB2YXIgcHBzID0gcHMubWF0Y2goL1woKFxTKnxcUypcc1xTKilcKS8pWzFdLnNwbGl0KC8gfCwvKTsNCiAgICAgICAgICAgIHZhciB4PXBhcnNlRmxvYXQoY3NbMF0pK3BhcnNlRmxvYXQocHBzWzBdKTsNCiAgICAgICAgICAgIHZhciB5PXBhcnNlRmxvYXQocHBzWzFdKTsNCiAgICAgICAgICAgIHg9eC50b3N1aXRzdmcoKTsNCiAgICAgICAgICAgIHk9eS50b3N1aXRzdmcoKTsNCiAgICAgICAgICAgIHZhciB0cnN0ciA9ICd0cmFuc2xhdGUoJyt4KycsJyt5KycpJzsNCiAgICAgICAgfWVsc2UgaWYocHMuc3Vic3RyKDAsMikgPT0gJ21hJyl7DQogICAgICAgICAgICB2YXIgcHBzID0gcHMubWF0Y2goLyhcLT9cZCsoXC5cZCspPylbXCwgXShcLT9cZCsoXC5cZCspPylbXCwgXShcLT9cZCsoXC5cZCspPylbXCwgXShcLT9cZCsoXC5cZCspPylbXCwgXShcLT9cZCsoXC5cZCspPylbXCwgXShcLT9cZCsoXC5cZCspPylcKSQvKTsNCiAgICAgICAgICAgIHZhciBtYUFyciA9IFtwYXJzZUZsb2F0KHBwc1sxXSkscGFyc2VGbG9hdChwcHNbM10pLHBhcnNlRmxvYXQocHBzWzVdKSxwYXJzZUZsb2F0KHBwc1s3XSkscGFyc2VGbG9hdChwcHNbOV0pLHBhcnNlRmxvYXQocHBzWzExXSldOw0KICAgICAgICAgICAgaWYobWFBcnJbMV0gPT0gMCl7DQogICAgICAgICAgICAgICAgdmFyIHggPSBwYXJzZUZsb2F0KGNzWzBdKTsNCiAgICAgICAgICAgICAgICB2YXIgeSA9IHBhcnNlRmxvYXQoY3NbMV0pKzE2Ow0KICAgICAgICAgICAgICAgIHZhciB4MSA9IHggKiBtYUFyclswXSArIHkgKiBtYUFyclsyXSArIG1hQXJyWzRdOw0KICAgICAgICAgICAgICAgIHZhciB5MSA9IHggKiBtYUFyclsxXSArIHkgKiBtYUFyclszXSArIG1hQXJyWzVdOw0KICAgICAgICAgICAgICAgIHgxPXgxLnRvc3VpdHN2ZygpOw0KICAgICAgICAgICAgICAgIHkxPXkxLnRvc3VpdHN2ZygpOw0KICAgICAgICAgICAgICAgIHZhciB0cnN0ciA9ICAndHJhbnNsYXRlKCcreDErJywnK3kxKycpJzsNCiAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgIHZhciB4ID0gcGFyc2VGbG9hdChjc1swXSkrMTY7DQogICAgICAgICAgICAgICAgdmFyIHkgPSBwYXJzZUZsb2F0KGNzWzFdKSsxNjsNCiAgICAgICAgICAgICAgICB2YXIgeDEgPSB4ICogbWFBcnJbMF0gKyB5ICogbWFBcnJbMl0gKyBtYUFycls0XTsNCiAgICAgICAgICAgICAgICB2YXIgeTEgPSB4ICogbWFBcnJbMV0gKyB5ICogbWFBcnJbM10gKyBtYUFycls1XTsNCiAgICAgICAgICAgICAgICB4ID0gcGFyc2VGbG9hdChjc1swXSkrMTY7DQogICAgICAgICAgICAgICAgeSA9IHBhcnNlRmxvYXQoY3NbMV0pOw0KICAgICAgICAgICAgICAgIHZhciB4MiA9IHggKiBtYUFyclswXSArIHkgKiBtYUFyclsyXSArIG1hQXJyWzRdOw0KICAgICAgICAgICAgICAgIHZhciB5MiA9IHggKiBtYUFyclsxXSArIHkgKiBtYUFyclszXSArIG1hQXJyWzVdOw0KICAgICAgICAgICAgICAgIHZhciBmeCA9IHgxPHgyP3gxLnRvc3VpdHN2ZygpOiB4Mi50b3N1aXRzdmcoKTsNCiAgICAgICAgICAgICAgICB2YXIgZnkgPSB5MT55Mj95MS50b3N1aXRzdmcoKTogeTIudG9zdWl0c3ZnKCk7DQoJCQkJdmFyIG9mZnkgPSBNYXRoLmFicyh5MS15Mik7CQkJCQkJCQkJCSAgDQogICAgICAgICAgICAgICAgdmFyIHRyc3RyID0gICd0cmFuc2xhdGUoJytmeCsnLCcrZnkrJyknOw0KICAgICAgICAgICAgICAgIHBvcHVwUi5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsb2ZmeS50b1N0cmluZygpKTsNCiAgICAgICAgICAgICAgICBwb3B1cFIuc2V0QXR0cmlidXRlKCd3aWR0aCcsJzE2Jyk7DQogICAgICAgICAgICAgICAgcG9wdXBSLnNldEF0dHJpYnV0ZSgneScsKC1vZmZ5KS50b1N0cmluZygpKTsNCiAgICAgICAgICAgICAgICBwb3B1cFIuc2V0QXR0cmlidXRlKCdmaWxsJywndHJhbnNwYXJlbnQnKTsNCiAgICAgICAgICAgICAgICBwb3B1cC5hcHBlbmRDaGlsZChwb3B1cFIpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIG91dC5zZXRBdHRyaWJ1dGUoJ3RyYW5zZm9ybScsdHJzdHIpOw0KICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjc3ZnLWNvbnRhaW5lciA+IHN2ZycpLmFwcGVuZENoaWxkKG91dCk7DQogICAgICAgIG5vdGVzW2ldLm9ubW91c2VvdmVyPWZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBub3RlaWQ9dGhpcy5wYXJlbnROb2RlLmlkOw0KICAgICAgICAgICAgdGhpcy5xdWVyeVNlbGVjdG9yKCdyZWN0Jykuc3R5bGUuZGlzcGxheT0nYmxvY2snOw0KICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiZ1tlZFxcOm5vdGVpZD0nIitub3RlaWQrIiddW25vdGVdIikuc3R5bGUuZGlzcGxheT0nYmxvY2snOw0KICAgICAgICB9Ow0KICAgICAgICBub3Rlc1tpXS5vbm1vdXNlb3V0PWZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBub3RlaWQ9dGhpcy5wYXJlbnROb2RlLmlkOw0KLy8gICAgICAgIHdpbmRvdy5nZXRTZWxlY3Rpb24oKS5yZW1vdmVBbGxSYW5nZXMoKTsNCiAgICAgICAgICAgIHRoaXMucXVlcnlTZWxlY3RvcigncmVjdCcpLnN0eWxlLmRpc3BsYXk9J25vbmUnOw0KICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiZ1tlZFxcOm5vdGVpZD0nIitub3RlaWQrIiddW25vdGVdIikuc3R5bGUuZGlzcGxheT0nbm9uZSc7DQogICAgICAgIH0NCiAgICB9DQp9ZWxzZXsNCiAgICBjb25zb2xlLmxvZygn5oqx5q2J77yMSUXmtY/op4jlmajkuI3mlK/mjIFub3Rl6Kej5p6Q77yM6K+35L2/55So5YW25LuW5YaF5qC45rWP6KeI5Zmo44CC6LCi6LCi77yBJykNCn0NCi8vLS1ub3RlDQovL2h5cGVybGluay0tDQp2YXIgbGlua3M9ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnZz5nW2VkXFw6aHlwZXJsaW5rXScpOw0KZnVuY3Rpb24gZ2V0bWF4bGVuKGFycixicnIpIHsNCiAgICB2YXIgbD0wOw0KICAgIHZhciBsbD0wOw0KICAgIGZvcih2YXIgaj0wO2o8YXJyLmxlbmd0aDtqKyspew0KICAgICAgICB2YXIgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywndGV4dCcpOw0KICAgICAgICBpZighaXNOYU4obGlua2FycltqXSkpew0KICAgICAgICAgICAgZS50ZXh0Q29udGVudD0nUGFnZS0nK2FycltqXTsNCiAgICAgICAgfWVsc2V7DQogICAgICAgICAgICBlLnRleHRDb250ZW50PWFycltqXTsNCiAgICAgICAgfQ0KICAgICAgICBlLnN0eWxlLmZvbnRTaXplPScxMnB4JzsNCiAgICAgICAgZG9jdW1lbnQuYm9keS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc3ZnJylbMF0uYXBwZW5kQ2hpbGQoZSk7DQogICAgICAgIHZhciBldz1lLmdldEJCb3goKS53aWR0aDsNCiAgICAgICAgZG9jdW1lbnQuYm9keS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc3ZnJylbMF0ucmVtb3ZlQ2hpbGQoZSk7DQogICAgICAgIHZhciBoPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCd0ZXh0Jyk7DQogICAgICAgIGgudGV4dENvbnRlbnQ9YnJyW2pdOw0KICAgICAgICBoLnN0eWxlLmZvbnRTaXplPScxMnB4JzsNCiAgICAgICAgaC5zdHlsZS5mb250V2VpZ2h0PSdib2xkJzsNCiAgICAgICAgZG9jdW1lbnQuYm9keS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc3ZnJylbMF0uYXBwZW5kQ2hpbGQoaCk7DQogICAgICAgIHZhciBodz1oLmdldEJCb3goKS53aWR0aDsNCiAgICAgICAgZG9jdW1lbnQuYm9keS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc3ZnJylbMF0ucmVtb3ZlQ2hpbGQoaCk7DQogICAgICAgIGw9ZXc+aHc/ZXc6aHc7DQogICAgICAgIGxsPWw+bGw/bDpsbDsNCiAgICB9DQogICAgcmV0dXJuIGxsOw0KfQ0KZm9yKHZhciBpPTA7aTxsaW5rcy5sZW5ndGg7aSsrKXsNCiAgICB2YXIgcG9wdXA9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsJ2cnKTsNCiAgICB2YXIgcG9wdXBSPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywncmVjdCcpOw0KICAgIHZhciBob3Zlcj1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywncmVjdCcpOw0KICAgIHZhciBkZXNjYXJyPVtdOw0KICAgIHZhciBsaW5rYXJyPVtdOw0KICAgIGhvdmVyLnNldEF0dHJpYnV0ZSgnZmlsbCcsJyNjZGNkZmYnKTsNCiAgICBob3Zlci5zZXRBdHRyaWJ1dGUoJ3gnLCcwJyk7DQogICAgaG92ZXIuc2V0QXR0cmlidXRlKCd5JywnMCcpOw0KICAgIGhvdmVyLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywnMTYnKTsNCiAgICBob3Zlci5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywnMTYnKTsNCiAgICBob3Zlci5zZXRBdHRyaWJ1dGUoJ2ZpbGwtb3BhY2l0eScsJzAuNicpOw0KICAgIGhvdmVyLnNldEF0dHJpYnV0ZSgndHJhbnNmb3JtJyxsaW5rc1tpXS5xdWVyeVNlbGVjdG9yKCd1c2UnKS5nZXRBdHRyaWJ1dGUoJ3RyYW5zZm9ybScpKTsNCiAgICBob3Zlci5zdHlsZS5kaXNwbGF5PSdub25lJzsNCiAgICBsaW5rc1tpXS5hcHBlbmRDaGlsZChob3Zlcik7DQogICAgLy8gY29uc29sZS5sb2cobGlua3NbaV0uZ2V0QXR0cmlidXRlKCdlZDpoeXBlcmxpbmsnKSk7DQogICAgdmFyIGE9SlNPTi5wYXJzZShsaW5rc1tpXS5nZXRBdHRyaWJ1dGUoJ2VkOmh5cGVybGluaycpKTsNCiAgICB2YXIgY3M9bGlua3NbaV0ucXVlcnlTZWxlY3RvcigndXNlJykuZ2V0QXR0cmlidXRlKCd0cmFuc2Zvcm0nKS5tYXRjaCgvXCgoXFMqfFxTKlxzXFMqKVwpLylbMV0uc3BsaXQoLyB8LC8pOw0KICAgIHZhciBwcz1saW5rc1tpXS5wYXJlbnROb2RlLmdldEF0dHJpYnV0ZSgndHJhbnNmb3JtJyk7DQogICAgaWYocHMuc3Vic3RyKDAsMikgPT0gJ3RyJyl7DQogICAgICAgIHZhciBwcHMgPSBwcy5tYXRjaCgvXCgoXFMqfFxTKlxzXFMqKVwpLylbMV0uc3BsaXQoLyB8LC8pOw0KICAgICAgICB2YXIgeD1wYXJzZUZsb2F0KGNzWzBdKStwYXJzZUZsb2F0KHBwc1swXSk7DQogICAgICAgIHZhciB5PXBhcnNlRmxvYXQocHBzWzFdKTsNCiAgICAgICAgeD14LnRvc3VpdHN2ZygpOw0KICAgICAgICB5PXkudG9zdWl0c3ZnKCk7DQogICAgICAgIHZhciB0cnN0ciA9ICd0cmFuc2xhdGUoJyt4KycsJyt5KycpJzsNCiAgICB9ZWxzZSBpZihwcy5zdWJzdHIoMCwyKSA9PSAnbWEnKXsNCiAgICAgICAgdmFyIHBwcyA9IHBzLm1hdGNoKC8oXC0/XGQrKFwuXGQrKT8pW1wsIF0oXC0/XGQrKFwuXGQrKT8pW1wsIF0oXC0/XGQrKFwuXGQrKT8pW1wsIF0oXC0/XGQrKFwuXGQrKT8pW1wsIF0oXC0/XGQrKFwuXGQrKT8pW1wsIF0oXC0/XGQrKFwuXGQrKT8pXCkkLyk7DQogICAgICAgIHZhciBtYUFyciA9IFtwYXJzZUZsb2F0KHBwc1sxXSkscGFyc2VGbG9hdChwcHNbM10pLHBhcnNlRmxvYXQocHBzWzVdKSxwYXJzZUZsb2F0KHBwc1s3XSkscGFyc2VGbG9hdChwcHNbOV0pLHBhcnNlRmxvYXQocHBzWzExXSldOw0KICAgICAgICBpZihtYUFyclsxXSA9PSAwKXsNCiAgICAgICAgICAgIHZhciB4ID0gcGFyc2VGbG9hdChjc1swXSk7DQogICAgICAgICAgICB2YXIgeSA9IHBhcnNlRmxvYXQoY3NbMV0pKzE2Ow0KICAgICAgICAgICAgdmFyIHgxID0geCAqIG1hQXJyWzBdICsgeSAqIG1hQXJyWzJdICsgbWFBcnJbNF07DQogICAgICAgICAgICB2YXIgeTEgPSB4ICogbWFBcnJbMV0gKyB5ICogbWFBcnJbM10gKyBtYUFycls1XTsNCiAgICAgICAgICAgIHgxPXgxLnRvc3VpdHN2ZygpOw0KICAgICAgICAgICAgeTE9eTEudG9zdWl0c3ZnKCk7DQogICAgICAgICAgICB2YXIgdHJzdHIgPSAgJ3RyYW5zbGF0ZSgnK3gxKycsJyt5MSsnKSc7DQogICAgICAgIH1lbHNlew0KICAgICAgICAgICAgdmFyIHggPSBwYXJzZUZsb2F0KGNzWzBdKSsxNjsNCiAgICAgICAgICAgIHZhciB5ID0gcGFyc2VGbG9hdChjc1sxXSkrMTY7DQogICAgICAgICAgICB2YXIgeDEgPSB4ICogbWFBcnJbMF0gKyB5ICogbWFBcnJbMl0gKyBtYUFycls0XTsNCiAgICAgICAgICAgIHZhciB5MSA9IHggKiBtYUFyclsxXSArIHkgKiBtYUFyclszXSArIG1hQXJyWzVdOw0KICAgICAgICAgICAgeCA9IHBhcnNlRmxvYXQoY3NbMF0pKzE2Ow0KICAgICAgICAgICAgeSA9IHBhcnNlRmxvYXQoY3NbMV0pOw0KICAgICAgICAgICAgdmFyIHgyID0geCAqIG1hQXJyWzBdICsgeSAqIG1hQXJyWzJdICsgbWFBcnJbNF07DQogICAgICAgICAgICB2YXIgeTIgPSB4ICogbWFBcnJbMV0gKyB5ICogbWFBcnJbM10gKyBtYUFycls1XTsNCiAgICAgICAgICAgIHZhciBmeCA9IHgxPHgyP3gxLnRvc3VpdHN2ZygpOiB4Mi50b3N1aXRzdmcoKTsNCiAgICAgICAgICAgIHZhciBmeSA9IHkxPnkyP3kxLnRvc3VpdHN2ZygpOiB5Mi50b3N1aXRzdmcoKTsNCgkJCXZhciBvZmZ5ID0gTWF0aC5hYnMoeTEteTIpOwkJCQkJCQkJCQkgIA0KICAgICAgICAgICAgdmFyIHRyc3RyID0gICd0cmFuc2xhdGUoJytmeCsnLCcrZnkrJyknOw0KICAgICAgICAgICAgcG9wdXBSLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JyxvZmZ5LnRvU3RyaW5nKCkpOw0KICAgICAgICAgICAgcG9wdXBSLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCcxNicpOw0KICAgICAgICAgICAgcG9wdXBSLnNldEF0dHJpYnV0ZSgneScsKC1vZmZ5KS50b1N0cmluZygpKTsNCiAgICAgICAgICAgIHBvcHVwUi5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCd0cmFuc3BhcmVudCcpOw0KICAgICAgICAgICAgcG9wdXAuYXBwZW5kQ2hpbGQocG9wdXBSKTsNCiAgICAgICAgfQ0KICAgIH0NCiAgICB2YXIgYWw9YS5sZW5ndGg7DQogICAgZm9yKHZhciBqPTA7ajxhbDtqKyspew0KICAgICAgICBsaW5rYXJyLnB1c2goYVtqXS5saW5rKTsNCiAgICAgICAgZGVzY2Fyci5wdXNoKGFbal0uZGVzYyk7DQogICAgfQ0KICAgIHBvcHVwLnNldEF0dHJpYnV0ZSgndHJhbnNmb3JtJyx0cnN0cik7DQogICAgdmFyIG1heD1nZXRtYXhsZW4obGlua2FycixkZXNjYXJyKTsNCiAgICBmb3IodmFyIGs9MDtrPGFsO2srKyl7DQogICAgICAgIHZhciBjPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCdhJyk7DQogICAgICAgIHZhciBkPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCdyZWN0Jyk7DQogICAgICAgIHZhciBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCd0ZXh0Jyk7DQogICAgICAgIHZhciBmPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCd0ZXh0Jyk7DQogICAgICAgIGlmKGlzTmFOKGxpbmthcnJba10pKXsNCiAgICAgICAgICAgIGMuc2V0QXR0cmlidXRlTlMoImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiwgInhsaW5rIiwgImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiKTsNCiAgICAgICAgICAgIGMuc2V0QXR0cmlidXRlTlMoImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiLCAiaHJlZiIsIGxpbmthcnJba10pOw0KICAgICAgICAgICAgYy5zZXRBdHRyaWJ1dGUoJ3RhcmdldCcsJ19ibGFuaycpOw0KICAgICAgICAgICAgZS50ZXh0Q29udGVudD1saW5rYXJyW2tdOw0KICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgIGUudGV4dENvbnRlbnQ9J1BhZ2UtJytsaW5rYXJyW2tdOw0KICAgICAgICAgICAgYy5zZXRBdHRyaWJ1dGVOUygiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciLCAieGxpbmsiLCAiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIpOw0KICAgICAgICAgICAgYy5zZXRBdHRyaWJ1dGVOUygiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIsICJocmVmIiwgIiMiK2xpbmthcnJba10pOw0KICAgICAgICB9DQogICAgICAgIGQuc2V0QXR0cmlidXRlKCd3aWR0aCcsbWF4KzEwKTsNCiAgICAgICAgZC5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsJzMzJyk7DQogICAgICAgIGQuc2V0QXR0cmlidXRlKCdzdHJva2UnLCcjOTk5OTk5Jyk7DQogICAgICAgIGQuc2V0QXR0cmlidXRlKCdmaWxsJywnd2hpdGUnKTsNCiAgICAgICAgZC5zZXRBdHRyaWJ1dGUoJ3knLDMzKmspOw0KICAgICAgICBmLnRleHRDb250ZW50PWRlc2NhcnJba107DQogICAgICAgIGYuc3R5bGUuZm9udFNpemU9JzEycHgnOw0KICAgICAgICBmLnN0eWxlLmZvbnRXZWlnaHQ9J2JvbGQnOw0KICAgICAgICBmLnNldEF0dHJpYnV0ZSgneCcsNSk7DQogICAgICAgIGYuc2V0QXR0cmlidXRlKCd5JywzMyprKzEyKTsNCiAgICAgICAgZS5zdHlsZS5mb250U2l6ZT0nMTJweCc7DQogICAgICAgIGUuc2V0QXR0cmlidXRlKCd5JywzMyprKzI4KTsNCiAgICAgICAgZS5zZXRBdHRyaWJ1dGUoJ3gnLDUpOw0KICAgICAgICBjLmFwcGVuZENoaWxkKGQpOw0KICAgICAgICBjLmFwcGVuZENoaWxkKGYpOw0KICAgICAgICBjLmFwcGVuZENoaWxkKGUpOw0KICAgICAgICBjLm9ubW91c2VvdmVyPWZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHRoaXMucXVlcnlTZWxlY3RvcigncmVjdCcpLnN0eWxlLmZpbGw9JyNlMWUxZmYnDQogICAgICAgIH07DQogICAgICAgIGMub25tb3VzZW91dD1mdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJ3JlY3QnKS5zdHlsZS5maWxsPSd3aGl0ZScNCiAgICAgICAgfTsNCiAgICAgICAgcG9wdXAuYXBwZW5kQ2hpbGQoYyk7DQogICAgfQ0KICAgIHBvcHVwLnN0eWxlLmRpc3BsYXk9J25vbmUnOw0KICAgIHBvcHVwLnNldEF0dHJpYnV0ZSgnaHlwZXJsaW5rJywnJyk7DQogICAgcG9wdXAuc2V0QXR0cmlidXRlKCdlZDpsaW5raWQnLGxpbmtzW2ldLnBhcmVudE5vZGUuaWQpOw0KICAgIHBvcHVwLm9ubW91c2VvdmVyPWZ1bmN0aW9uICgpIHsNCiAgICAgICAgdGhpcy5zdHlsZS5kaXNwbGF5PSdibG9jayc7DQogICAgfTsNCiAgICBwb3B1cC5vbmNsaWNrPWZ1bmN0aW9uICgpIHsNCiAgICAgICAgdGhpcy5zdHlsZS5kaXNwbGF5PSdub25lJzsNCiAgICB9Ow0KICAgIHBvcHVwLm9ubW91c2VvdXQ9ZnVuY3Rpb24gKCkgew0KICAgICAgICB0aGlzLnN0eWxlLmRpc3BsYXk9J25vbmUnOw0KICAgIH07DQogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3N2Zy1jb250YWluZXIgPiBzdmcnKS5hcHBlbmRDaGlsZChwb3B1cCk7DQogICAgbGlua3NbaV0ub25tb3VzZW92ZXI9ZnVuY3Rpb24gKCkgew0KICAgICAgICB2YXIgbGlua2lkPXRoaXMucGFyZW50Tm9kZS5pZDsNCiAgICAgICAgdGhpcy5xdWVyeVNlbGVjdG9yKCdyZWN0Jykuc3R5bGUuZGlzcGxheT0nYmxvY2snOw0KICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJnW2VkXFw6bGlua2lkPSciK2xpbmtpZCsiJ11baHlwZXJsaW5rXSIpLnN0eWxlLmRpc3BsYXk9J2Jsb2NrJzsNCiAgICB9DQogICAgbGlua3NbaV0ub25tb3VzZW91dD1mdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciBsaW5raWQ9dGhpcy5wYXJlbnROb2RlLmlkOw0KICAgICAgICB0aGlzLnF1ZXJ5U2VsZWN0b3IoJ3JlY3QnKS5zdHlsZS5kaXNwbGF5PSdub25lJzsNCiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiZ1tlZFxcOmxpbmtpZD0nIitsaW5raWQrIiddW2h5cGVybGlua10iKS5zdHlsZS5kaXNwbGF5PSdub25lJzsNCiAgICB9DQp9DQovLy0taHlwZXJsaW5rDQovL2luaXRpYWxpemUtLQ0KdmFyIHNoYXBlPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2dbZWRcXDp0b2d0b3BpY2lkXScpOw0KdmFyIG1JZD1kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdnW2VkXFw6dG9waWN0eXBlXScpOw0KdmFyIGRhdGFUcmVlPXt9Ow0KdmFyIGV4dHJhUmVsYT17fTsNCnZhciBjaGVja0lEPScnOw0KZm9yKHZhciBpPTA7aTxtSWQubGVuZ3RoO2krKyl7DQogICAgdmFyIHR5cGU9bUlkW2ldLmdldEF0dHJpYnV0ZSgnZWQ6dG9waWN0eXBlJyk7DQogICAgdmFyIHNpZD1tSWRbaV0uaWQ7DQogICAgaWYodHlwZSE9PSdjYWxsb3V0Jyl7DQogICAgICAgIGluaXQoc2lkLGRhdGFUcmVlKQ0KICAgIH0NCn0NCmZ1bmN0aW9uIGluaXQoaWQsIG9iaikgew0KICAgIHZhciBjaGlsZHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJnW2VkXFw6cGFyZW50aWQ9JyIgKyBpZCArICInXTpub3QoW2VkXFw6dG9waWN0eXBlXSkiKTsNCiAgICB2YXIgY2FsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJnW2VkXFw6cGFyZW50aWQ9JyIgKyBpZCArICInXVtlZFxcOnRvcGljdHlwZV0iKTsNCiAgICB2YXIgc3VtbWFyeSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoInBhdGhbZWRcXDpwYXJlbnRpZCo9JyIgKyBpZCArICInXVtlZFxcOnR5cGU9J3N1bW1hcnknXSIpOw0KICAgIHZhciBib3VuZGFyeT0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgicGF0aFtlZFxcOnBhcmVudGlkKj0nIiArIGlkICsgIiddW2VkXFw6dHlwZT0nYm91bmRhcnknXSIpOw0KICAgIHZhciByZWxhZnJvbT1kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJnW2VkXFw6ZnJvbWlkKj0nIiArIGlkICsgIiddW2VkXFw6dHlwZT0ncmVsYXRpb24nXSIpOw0KICAgIHZhciByZWxhdG89ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgiZ1tlZFxcOnRvaWQqPSciICsgaWQgKyAiJ11bZWRcXDp0eXBlPSdyZWxhdGlvbiddIik7DQogICAgb2JqWyJtIiArIGlkXSA9IHt9Ow0KICAgIHZhciB0eXBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLmdldEF0dHJpYnV0ZSgnZWQ6dG9waWN0eXBlJyk7DQogICAgdmFyIGl3PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS5nZXRBdHRyaWJ1dGUoJ2VkOndpZHRoJyk7DQogICAgdmFyIGloPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKS5nZXRBdHRyaWJ1dGUoJ2VkOmhlaWdodCcpOw0KICAgIGlmICh0eXBlKSB7DQogICAgICAgIG9ialsibSIgKyBpZF0udHlwZSA9IHR5cGU7DQogICAgfQ0KICAgIGlmKGl3JiZpaCl7DQogICAgICAgIG9ialsibSIgKyBpZF0ud2lkdGggPWl3Ow0KICAgICAgICBvYmpbIm0iICsgaWRdLmhlaWdodCA9aWg7DQogICAgfQ0KICAgIGlmIChyZWxhZnJvbS5sZW5ndGggIT09IDApIHsNCiAgICAgICAgb2JqWyJtIiArIGlkXS5yZWxhZnJvbSA9IHt9Ow0KICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlbGFmcm9tLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICB2YXIgaW5kZXhpZCA9IHJlbGFmcm9tW2ldLmlkOw0KICAgICAgICAgICAgdmFyIHRvaWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpbmRleGlkKS5nZXRBdHRyaWJ1dGUoJ2VkOnRvaWQnKTsNCiAgICAgICAgICAgIGlmIChleHRyYVJlbGFbaW5kZXhpZF0gPT09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgIGV4dHJhUmVsYVtpbmRleGlkXSA9IHsNCiAgICAgICAgICAgICAgICAgICAgaWQ6IGluZGV4aWQsDQogICAgICAgICAgICAgICAgICAgIGZyb21pZDogaWQsDQogICAgICAgICAgICAgICAgICAgIHRvaWQ6IHRvaWQsDQogICAgICAgICAgICAgICAgICAgIGlzQzogZmFsc2UNCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgb2JqWyJtIiArIGlkXS5yZWxhZnJvbVtpbmRleGlkXT17fTsNCiAgICAgICAgICAgIG9ialsibSIgKyBpZF0ucmVsYWZyb20uZGlzcGxheT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnPydibG9jayc6J25vbmUnOw0KICAgICAgICB9DQogICAgfQ0KICAgIGlmIChyZWxhdG8ubGVuZ3RoICE9PSAwKSB7DQogICAgICAgIG9ialsibSIgKyBpZF0ucmVsYXRvID0ge307DQogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVsYXRvLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICB2YXIgaW5kZXhpZD1yZWxhdG9baV0uaWQ7DQogICAgICAgICAgICB2YXIgZnJvbWlkPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGluZGV4aWQpLmdldEF0dHJpYnV0ZSgnZWQ6ZnJvbWlkJyk7DQogICAgICAgICAgICBpZihleHRyYVJlbGFbaW5kZXhpZF0gPT09IHVuZGVmaW5lZCl7DQogICAgICAgICAgICAgICAgZXh0cmFSZWxhW2luZGV4aWRdPXsNCiAgICAgICAgICAgICAgICAgICAgaWQ6aW5kZXhpZCwNCiAgICAgICAgICAgICAgICAgICAgZnJvbWlkOmZyb21pZCwNCiAgICAgICAgICAgICAgICAgICAgdG9pZDppZCwNCiAgICAgICAgICAgICAgICAgICAgaXNDOmZhbHNlDQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIG9ialsibSIgKyBpZF0ucmVsYXRvW2luZGV4aWRdPXt9Ow0KICAgICAgICAgICAgb2JqWyJtIiArIGlkXS5yZWxhdG8uZGlzcGxheT1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnPydibG9jayc6J25vbmUnOw0KICAgICAgICB9DQogICAgfQ0KICAgIGlmIChjaGlsZHMubGVuZ3RoICE9PSAwKSB7DQogICAgICAgIG9ialsibSIgKyBpZF0uY2hpbGQgPSB7fTsNCiAgICAgICAgaWYgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoImdbZWRcXDp0b2d0b3BpY2lkPSciICsgaWQgKyAiJ10iKSkgew0KICAgICAgICAgICAgLy8gY29uc29sZS5sb2coZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiZ1tlZFxcOnRvZ3RvcGljaWQ9JyIgKyBpZCArICInXSIpLmNoaWxkTm9kZXNbMF0uZ2V0QXR0cmlidXRlKCd4bGluazpocmVmJykpOw0KICAgICAgICAgICAgdmFyIHRvZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoImdbZWRcXDp0b2d0b3BpY2lkPSciICsgaWQgKyAiJ10iKS5nZXRFbGVtZW50c0J5VGFnTmFtZSgndXNlJylbMF0uZ2V0QXR0cmlidXRlKCd4bGluazpocmVmJykuc2xpY2UoMSk7DQogICAgICAgICAgICBvYmpbIm0iICsgaWRdLnRvZ3R5cGUgPSB0b2c7DQogICAgICAgIH0NCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGlsZHMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIHZhciBjaWQgPSBjaGlsZHNbaV0uaWQ7DQogICAgICAgICAgICBpbml0KGNpZCwgb2JqWyJtIiArIGlkXS5jaGlsZCk7DQogICAgICAgIH0NCiAgICB9DQogICAgaWYgKGNhbGxzLmxlbmd0aCAhPT0gMCkgew0KICAgICAgICBvYmpbIm0iICsgaWRdLmNhbGwgPSB7fTsNCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYWxscy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgdmFyIGNpZCA9IGNhbGxzW2ldLmlkOw0KICAgICAgICAgICAgaW5pdChjaWQsIG9ialsibSIgKyBpZF0uY2FsbCk7DQogICAgICAgIH0NCiAgICB9DQogICAgaWYgKGJvdW5kYXJ5Lmxlbmd0aCAhPT0gMCkgew0KICAgICAgICBvYmpbIm0iICsgaWRdLmJvdW5kYXJ5ID0ge307DQogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYm91bmRhcnkubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIHZhciBjaWQgPWJvdW5kYXJ5W2ldLmlkOw0KICAgICAgICAgICAgaW5pdChjaWQsIG9ialsibSIgKyBpZF0uYm91bmRhcnkpOw0KICAgICAgICB9DQogICAgfQ0KICAgIGlmIChzdW1tYXJ5Lmxlbmd0aCAhPT0gMCkgew0KICAgICAgICBvYmpbIm0iICsgaWRdLnN1bW1hcnkgPSB7fTsNCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdW1tYXJ5Lmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICB2YXIgY2lkID0gc3VtbWFyeVtpXS5pZDsNCiAgICAgICAgICAgIGluaXQoY2lkLCBvYmpbIm0iICsgaWRdLnN1bW1hcnkpOw0KICAgICAgICB9DQogICAgfQ0KfQ0KLy8tLWluaXRpYWxpemUNCi8vdG9nZ2xlZGlzcGxheS0tDQp2YXIgY2hhaW5BcnI9W107DQpmdW5jdGlvbiBnZXRjaGFpbihpZCl7DQogICAgY2hhaW5BcnIudW5zaGlmdCgnbScraWQpOw0KICAgIHZhciBwYXJlbnQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpLmdldEF0dHJpYnV0ZSgnZWQ6cGFyZW50aWQnKTsNCiAgICBpZighcGFyZW50KXsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCglpZihwYXJlbnQubWF0Y2goL1wsLykpew0KICAgICAgICBwYXJlbnQgPSBwYXJlbnQubWF0Y2goL1xkKyg/PVwsKS8pWzBdDQogICAgfQ0KICAgIGdldGNoYWluKHBhcmVudCk7DQp9DQpmdW5jdGlvbiBnZXRvYmooaWQpIHsNCiAgICBjaGFpbkFycj1bXTsNCiAgICBnZXRjaGFpbihpZCk7DQogICAgdmFyIG1haW49Y2hhaW5BcnJbMF07DQogICAgaWYoY2hhaW5BcnIubGVuZ3RoPjEpew0KICAgICAgICB2YXIgb2JqPWRhdGFUcmVlW21haW5dOw0KICAgICAgICAvLyBjb25zb2xlLmxvZyhjaGFpbkFycik7DQogICAgICAgIGZvcih2YXIgaT0xO2k8Y2hhaW5BcnIubGVuZ3RoO2krKykgew0KICAgICAgICAgICAgdmFyIGEgPSBjaGFpbkFycltpXTsNCiAgICAgICAgICAgIGZvcih2YXIgaj0wO2o8T2JqZWN0LmtleXMob2JqKS5sZW5ndGg7aisrKXsNCiAgICAgICAgICAgICAgICB2YXIgY29iaj0gb2JqW09iamVjdC5rZXlzKG9iailbal1dW2FdOw0KICAgICAgICAgICAgICAgIGlmKGNvYmopew0KICAgICAgICAgICAgICAgICAgICBvYmo9Y29iajsNCiAgICAgICAgICAgICAgICAgICAgY29udGludWUNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIG9iag0KICAgIH1lbHNlew0KICAgICAgICB2YXIgb2JqPWRhdGFUcmVlW21haW5dOw0KICAgICAgICByZXR1cm4gb2JqDQogICAgfQ0KDQp9DQpmb3IodmFyIGk9MDtpPHNoYXBlLmxlbmd0aDtpKyspew0KICAgIHNoYXBlW2ldLm9uY2xpY2s9ZnVuY3Rpb24gKCkgew0KICAgICAgICB2YXIgaWQ9TnVtYmVyKHRoaXMuZ2V0QXR0cmlidXRlKCdlZDp0b2d0b3BpY2lkJykpOw0KICAgICAgICB2YXIgb2JqPWdldG9iaihpZCk7DQoNCiAgICAgICAgdmFyIHR5cGU9b2JqLnRvZ3R5cGU9PT0nbWludXMnPydwbHVzJzonbWludXMnOw0KICAgICAgICB2YXIgZGlzcGxheT1vYmoudG9ndHlwZT09PSdtaW51cyc/J25vbmUnOidibG9jayc7DQogICAgICAgIHRoaXMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3VzZScpWzBdLnNldEF0dHJpYnV0ZSgneGxpbms6aHJlZicsJyMnK3R5cGUpOw0KICAgICAgICBvYmoudG9ndHlwZT10eXBlOw0KICAgICAgICBjaGVja0lEPW9iajsNCg0KICAgICAgICB1dGQob2JqLGlkLGRpc3BsYXkpOw0KICAgICAgICBleHRyYVJlbGFGaW4oKTsNCiAgICB9DQp9DQpmdW5jdGlvbiB1dGQob2JqLGlkLHNob3csb2MpIHsNCg0KICAgIHZhciBwc2hvdz1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCkuc3R5bGUuZGlzcGxheSE9PSAnbm9uZSc/J2Jsb2NrJzonbm9uZSc7DQogICAgaWYgKG9iai5yZWxhZnJvbSl7DQogICAgICAgIGlmKG9iai5yZWxhZnJvbS5kaXNwbGF5IT09IHBzaG93KXsNCiAgICAgICAgICAgIHZhciByZWxhZnJvbXM9T2JqZWN0LmtleXMob2JqLnJlbGFmcm9tKTsNCiAgICAgICAgICAgIHJlbGFmcm9tcy5zcGxpY2UocmVsYWZyb21zLmluZGV4T2YoJ2Rpc3BsYXknKSwxKTsNCiAgICAgICAgICAgIGZvcih2YXIgaz0wO2s8cmVsYWZyb21zLmxlbmd0aDtrKyspew0KICAgICAgICAgICAgICAgIHZhciBkPXJlbGFmcm9tc1trXTsNCiAgICAgICAgICAgICAgICBleHRyYVJlbGFbZF0uaXNDPXRydWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBvYmoucmVsYWZyb20uZGlzcGxheSA9IHBzaG93Ow0KICAgICAgICB9DQogICAgfQ0KICAgIGlmIChvYmoucmVsYXRvKXsNCiAgICAgICAgaWYob2JqLnJlbGF0by5kaXNwbGF5IT09IHBzaG93KXsNCiAgICAgICAgICAgIHZhciByZWxhdG9zPU9iamVjdC5rZXlzKG9iai5yZWxhdG8pOw0KICAgICAgICAgICAgcmVsYXRvcy5zcGxpY2UocmVsYXRvcy5pbmRleE9mKCdkaXNwbGF5JyksMSk7DQogICAgICAgICAgICBmb3IodmFyIGs9MDtrPHJlbGF0b3MubGVuZ3RoO2srKyl7DQogICAgICAgICAgICAgICAgdmFyIGQ9cmVsYXRvc1trXTsNCiAgICAgICAgICAgICAgICBleHRyYVJlbGFbZF0uaXNDPXRydWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBvYmoucmVsYXRvLmRpc3BsYXkgPSBwc2hvdzsNCiAgICAgICAgfQ0KICAgIH0NCiAgICBpZihvYmouY2FsbCl7DQogICAgICAgIHZhciBjYWxscz1PYmplY3Qua2V5cyhvYmouY2FsbCk7DQogICAgICAgIGlmKGNoZWNrSUQhPT1vYmopew0KICAgICAgICAgICAgZm9yKHZhciBpPTA7aSA8IGNhbGxzLmxlbmd0aDtpKyspew0KICAgICAgICAgICAgICAgIHZhciBhPWNhbGxzW2ldLnNsaWNlKDEpOw0KICAgICAgICAgICAgICAgIHZhciBiPW9iai5jYWxsW2NhbGxzW2ldXTsNCiAgICAgICAgICAgICAgICB2YXIgYz1iLnRvZ3R5cGU7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYSkuc3R5bGUuZGlzcGxheT1zaG93Ow0KICAgICAgICAgICAgICAgIGlmIChiLnJlbGFmcm9tJiYhYyl7DQogICAgICAgICAgICAgICAgICAgIGlmKGIucmVsYWZyb20uZGlzcGxheSE9PSBzaG93KXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWxhZnJvbXM9T2JqZWN0LmtleXMoYi5yZWxhZnJvbSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZWxhZnJvbXMuc3BsaWNlKHJlbGFmcm9tcy5pbmRleE9mKCdkaXNwbGF5JyksMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGs9MDtrPHJlbGFmcm9tcy5sZW5ndGg7aysrKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZD1yZWxhZnJvbXNba107DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFSZWxhW2RdLmlzQz10cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYi5yZWxhZnJvbS5kaXNwbGF5ID0gc2hvdzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoYi5yZWxhdG8mJiFjKXsNCiAgICAgICAgICAgICAgICAgICAgaWYoYi5yZWxhdG8uZGlzcGxheSE9PSBzaG93KXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWxhdG9zPU9iamVjdC5rZXlzKGIucmVsYXRvKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlbGF0b3Muc3BsaWNlKHJlbGF0b3MuaW5kZXhPZignZGlzcGxheScpLDEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBrPTA7azxyZWxhdG9zLmxlbmd0aDtrKyspew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkPXJlbGF0b3Nba107DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFSZWxhW2RdLmlzQz10cnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgYi5yZWxhdG8uZGlzcGxheSA9IHNob3c7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYoYyl7DQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoImdbZWRcXDp0b2d0b3BpY2lkPSciK2ErIiddIikuc3R5bGUuZGlzcGxheT1zaG93Ow0KICAgICAgICAgICAgICAgICAgICBpZihjPT09J21pbnVzJyl7DQogICAgICAgICAgICAgICAgICAgICAgICB1dGQoYixhLHNob3cpDQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKChiLmNhbGx8fGIuYm91bmRhcnl8fGIuc3VtbWFyeSkmJmM9PT0ncGx1cycpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHV0ZChiLGEsc2hvdyx0cnVlKQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmKGIuY2FsbCYmIWMpIHsNCiAgICAgICAgICAgICAgICAgICAgdXRkKGIsYSxzaG93LHRydWUpDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChiLnN1bW1hcnkmJiFjKSB7DQogICAgICAgICAgICAgICAgICAgIHV0ZChiLGEsc2hvdykNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKGIuYm91bmRhcnkmJiFjKSB7DQogICAgICAgICAgICAgICAgICAgIHV0ZChiLGEsc2hvdykNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICBpZihvYmouc3VtbWFyeSl7DQogICAgICAgIHZhciBzdW1tYXJ5cz1PYmplY3Qua2V5cyhvYmouc3VtbWFyeSk7DQogICAgICAgIGlmKChjaGVja0lEIT09b2JqJiYob2JqLnRvZ3R5cGU9PT0nbWludXMnfHwhb2JqLnRvZ3R5cGUpKXx8Y2hlY2tJRD09PW9iail7DQogICAgICAgICAgICBmb3IodmFyIGk9MDtpPHN1bW1hcnlzLmxlbmd0aDtpKyspew0KICAgICAgICAgICAgICAgIHZhciBhPXN1bW1hcnlzW2ldLnNsaWNlKDEpOw0KCQkJCXZhciBvc3AgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChhKS5nZXRBdHRyaWJ1dGUoJ2VkOnBhcmVudGlkJyk7DQogICAgICAgICAgICAgICAgaWYob3NwLm1hdGNoKC9cLC8pKXsNCiAgICAgICAgICAgICAgICAgICAgdmFyIG9zcGEgPSBvc3Auc3BsaXQoJywnKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIG9zcEw9MDsNCg0KICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGo9MDtqPG9zcGEubGVuZ3RoO2orKyl7DQogICAgICAgICAgICAgICAgICAgICAgICBpZihzaG93ID09ICdub25lJyl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQob3NwYVtqXSkuc3R5bGUuZGlzcGxheSAhPSAnbm9uZScpew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ZWxzZXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3NwTCsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChhKS5zdHlsZS5kaXNwbGF5ICE9ICdub25lJyl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvc3BMKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmKG9zcEwgIT09IG9zcGEubGVuZ3RoKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHZhciBiPW9iai5zdW1tYXJ5W3N1bW1hcnlzW2ldXTsNCiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhhKTsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChhKS5zdHlsZS5kaXNwbGF5PXNob3c7DQovLyAgICAgICAgICAgICAgICBpZihjKXsNCi8vICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJnW2VkXFw6dG9ndG9waWNpZD0nIithKyInXSIpLnN0eWxlLmRpc3BsYXk9c2hvdzsNCi8vICAgICAgICAgICAgICAgICAgICBpZihjPT09J21pbnVzJyl7DQovLyAgICAgICAgICAgICAgICAgICAgICAgIHV0ZChiLHNob3cpDQovLyAgICAgICAgICAgICAgICAgICAgfQ0KLy8gICAgICAgICAgICAgICAgICAgIGlmIChiLmNhbGwmJmM9PT0ncGx1cycpIHsNCi8vICAgICAgICAgICAgICAgICAgICAgICAgdXRkKGIsc2hvdyx0cnVlKQ0KLy8gICAgICAgICAgICAgICAgICAgIH0NCi8vICAgICAgICAgICAgICAgIH0NCi8vICAgICAgICAgICAgICAgIGlmKGIuY2FsbCYmIWMpIHsNCi8vICAgICAgICAgICAgICAgICAgICB1dGQoYixzaG93LHRydWUpDQovLyAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYoT2JqZWN0LmtleXMoYikubGVuZ3RoIT09MCl7DQogICAgICAgICAgICAgICAgICAgIHV0ZChiLGEsc2hvdykNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgaWYob2JqLmJvdW5kYXJ5KXsNCiAgICAgICAgdmFyIGJvdW5kYXJ5cz1PYmplY3Qua2V5cyhvYmouYm91bmRhcnkpOw0KICAgICAgICBpZihjaGVja0lEIT09b2JqKXsNCiAgICAgICAgICAgIGZvcih2YXIgaT0wO2k8Ym91bmRhcnlzLmxlbmd0aDtpKyspew0KICAgICAgICAgICAgICAgIHZhciBhPWJvdW5kYXJ5c1tpXS5zbGljZSgxKTsNCiAgICAgICAgICAgICAgICB2YXIgYj1vYmouYm91bmRhcnlbYm91bmRhcnlzW2ldXTsNCiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhhKTsNCiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChhKS5zdHlsZS5kaXNwbGF5PXNob3c7DQovLyAgICAgICAgICAgICAgICBpZihjKXsNCi8vICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJnW2VkXFw6dG9ndG9waWNpZD0nIithKyInXSIpLnN0eWxlLmRpc3BsYXk9c2hvdzsNCi8vICAgICAgICAgICAgICAgICAgICBpZihjPT09J21pbnVzJyl7DQovLyAgICAgICAgICAgICAgICAgICAgICAgIHV0ZChiLHNob3cpDQovLyAgICAgICAgICAgICAgICAgICAgfQ0KLy8gICAgICAgICAgICAgICAgICAgIGlmIChiLmNhbGwmJmM9PT0ncGx1cycpIHsNCi8vICAgICAgICAgICAgICAgICAgICAgICAgdXRkKGIsc2hvdyx0cnVlKQ0KLy8gICAgICAgICAgICAgICAgICAgIH0NCi8vICAgICAgICAgICAgICAgIH0NCi8vICAgICAgICAgICAgICAgIGlmKGIuY2FsbCYmIWMpIHsNCi8vICAgICAgICAgICAgICAgICAgICB1dGQoYixzaG93LHRydWUpDQovLyAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYoT2JqZWN0LmtleXMoYikubGVuZ3RoIT09MCl7DQogICAgICAgICAgICAgICAgICAgIHV0ZChiLGEsc2hvdykNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQogICAgaWYoIW9jJiZvYmouY2hpbGQpIHsNCiAgICAgICAgdmFyIGNoaWxkcyA9IE9iamVjdC5rZXlzKG9iai5jaGlsZCk7DQogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hpbGRzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICB2YXIgYSA9IGNoaWxkc1tpXS5zbGljZSgxKTsNCiAgICAgICAgICAgIHZhciBiID0gb2JqLmNoaWxkW2NoaWxkc1tpXV07DQogICAgICAgICAgICB2YXIgYyA9IGIudG9ndHlwZTsNCiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGEpLnN0eWxlLmRpc3BsYXkgPSBzaG93Ow0KCQkJdmFyIHRTUGF0aCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoInBhdGhbZWRcXDp0b3N1cGVyaWQ9JyIrYSsiJ10iKTsNCiAgICAgICAgICAgIGlmKHRTUGF0aCl7DQogICAgICAgICAgICAgICAgdFNQYXRoLnN0eWxlLmRpc3BsYXkgPSBzaG93Ow0KICAgICAgICAgICAgfQ0KCQkJdmFyIG5vdGVUaXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCJnW2VkXFw6bm90ZXRvPSciK2ErIiddIik7DQogICAgICAgICAgICBpZihub3RlVGlwKXsNCiAgICAgICAgICAgICAgICBub3RlVGlwLnN0eWxlLmRpc3BsYXkgPSBzaG93Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKGIucmVsYWZyb20mJiFjKXsNCiAgICAgICAgICAgICAgICBpZihiLnJlbGFmcm9tLmRpc3BsYXkhPT0gc2hvdyl7DQogICAgICAgICAgICAgICAgICAgIHZhciByZWxhZnJvbXM9T2JqZWN0LmtleXMoYi5yZWxhZnJvbSk7DQogICAgICAgICAgICAgICAgICAgIHJlbGFmcm9tcy5zcGxpY2UocmVsYWZyb21zLmluZGV4T2YoJ2Rpc3BsYXknKSwxKTsNCiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBrPTA7azxyZWxhZnJvbXMubGVuZ3RoO2srKyl7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZD1yZWxhZnJvbXNba107DQogICAgICAgICAgICAgICAgICAgICAgICBleHRyYVJlbGFbZF0uaXNDPXRydWU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgYi5yZWxhZnJvbS5kaXNwbGF5ID0gc2hvdzsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoYi5yZWxhdG8mJiFjKXsNCiAgICAgICAgICAgICAgICBpZihiLnJlbGF0by5kaXNwbGF5IT09IHNob3cpew0KICAgICAgICAgICAgICAgICAgICB2YXIgcmVsYXRvcz1PYmplY3Qua2V5cyhiLnJlbGF0byk7DQogICAgICAgICAgICAgICAgICAgIHJlbGF0b3Muc3BsaWNlKHJlbGF0b3MuaW5kZXhPZignZGlzcGxheScpLDEpOw0KICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGs9MDtrPHJlbGF0b3MubGVuZ3RoO2srKyl7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZD1yZWxhdG9zW2tdOw0KICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmFSZWxhW2RdLmlzQz10cnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGIucmVsYXRvLmRpc3BsYXkgPSBzaG93Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmIChjKSB7DQogICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcigiZ1tlZFxcOnRvZ3RvcGljaWQ9JyIgKyBhICsgIiddIikuc3R5bGUuZGlzcGxheSA9IHNob3c7DQogICAgICAgICAgICAgICAgaWYgKGMgPT09ICdtaW51cycpIHsNCiAgICAgICAgICAgICAgICAgICAgdXRkKGIsYSxzaG93KQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoKGIuY2FsbHx8Yi5ib3VuZGFyeXx8Yi5zdW1tYXJ5KSYmYz09PSdwbHVzJykgew0KICAgICAgICAgICAgICAgICAgICB1dGQoYixhLHNob3csdHJ1ZSkNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoYi5jYWxsJiYhYykgew0KICAgICAgICAgICAgICAgIHV0ZChiLGEsc2hvdyx0cnVlKQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKGIuc3VtbWFyeSYmIWMpIHsNCiAgICAgICAgICAgICAgICB1dGQoYixhLHNob3cpDQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoYi5ib3VuZGFyeSYmIWMpIHsNCiAgICAgICAgICAgICAgICB1dGQoYixhLHNob3cpDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQp9DQoNCmZ1bmN0aW9uIGV4dHJhUmVsYUZpbigpIHsNCiAgICB2YXIgZXh0cmFrZXlzPU9iamVjdC5rZXlzKGV4dHJhUmVsYSk7DQogICAgZm9yKHZhciBpPTA7aTxleHRyYWtleXMubGVuZ3RoO2krKyl7DQogICAgICAgIHZhciBleHRyYU9iaj1leHRyYVJlbGFbZXh0cmFrZXlzW2ldXTsNCiAgICAgICAgaWYoZXh0cmFPYmouaXNDID09PSB0cnVlKXsNCiAgICAgICAgICAgIHZhciBmc2hvdz1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChleHRyYU9iai5mcm9taWQpLnN0eWxlLmRpc3BsYXkgIT09J25vbmUnPyB0cnVlOiBmYWxzZTsNCiAgICAgICAgICAgIHZhciB0c2hvdz1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChleHRyYU9iai50b2lkKS5zdHlsZS5kaXNwbGF5ICE9PSdub25lJz8gdHJ1ZTogZmFsc2U7DQogICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChleHRyYU9iai5pZCkuc3R5bGUuZGlzcGxheT1mc2hvdyAmJiB0c2hvdz8gJ2Jsb2NrJzogJ25vbmUnOw0KICAgICAgICAgICAgZXh0cmFSZWxhW2V4dHJha2V5c1tpXV0uaXNDID0gZmFsc2U7DQogICAgICAgIH0NCiAgICB9DQp9'))</script>
  </body>
</html>
